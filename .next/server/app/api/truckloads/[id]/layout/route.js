/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/truckloads/[id]/layout/route";
exports.ids = ["app/api/truckloads/[id]/layout/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "pg":
/*!*********************!*\
  !*** external "pg" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("pg");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("net");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

"use strict";
module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("path");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("querystring");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("tls");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ }),

/***/ "?66e9":
/*!********************************!*\
  !*** utf-8-validate (ignored) ***!
  \********************************/
/***/ (() => {

/* (ignored) */

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftruckloads%2F%5Bid%5D%2Flayout%2Froute&page=%2Fapi%2Ftruckloads%2F%5Bid%5D%2Flayout%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftruckloads%2F%5Bid%5D%2Flayout%2Froute.ts&appDir=%2FUsers%2Freeceschlabach%2FDesktop%2FTimberline%20Internal%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Freeceschlabach%2FDesktop%2FTimberline%20Internal&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftruckloads%2F%5Bid%5D%2Flayout%2Froute&page=%2Fapi%2Ftruckloads%2F%5Bid%5D%2Flayout%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftruckloads%2F%5Bid%5D%2Flayout%2Froute.ts&appDir=%2FUsers%2Freeceschlabach%2FDesktop%2FTimberline%20Internal%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Freeceschlabach%2FDesktop%2FTimberline%20Internal&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_reeceschlabach_Desktop_Timberline_Internal_app_api_truckloads_id_layout_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/truckloads/[id]/layout/route.ts */ \"(rsc)/./app/api/truckloads/[id]/layout/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/truckloads/[id]/layout/route\",\n        pathname: \"/api/truckloads/[id]/layout\",\n        filename: \"route\",\n        bundlePath: \"app/api/truckloads/[id]/layout/route\"\n    },\n    resolvedPagePath: \"/Users/reeceschlabach/Desktop/Timberline Internal/app/api/truckloads/[id]/layout/route.ts\",\n    nextConfigOutput,\n    userland: _Users_reeceschlabach_Desktop_Timberline_Internal_app_api_truckloads_id_layout_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/truckloads/[id]/layout/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ0cnVja2xvYWRzJTJGJTVCaWQlNUQlMkZsYXlvdXQlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnRydWNrbG9hZHMlMkYlNUJpZCU1RCUyRmxheW91dCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnRydWNrbG9hZHMlMkYlNUJpZCU1RCUyRmxheW91dCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnJlZWNlc2NobGFiYWNoJTJGRGVza3RvcCUyRlRpbWJlcmxpbmUlMjBJbnRlcm5hbCUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZyZWVjZXNjaGxhYmFjaCUyRkRlc2t0b3AlMkZUaW1iZXJsaW5lJTIwSW50ZXJuYWwmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDeUM7QUFDdEg7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSx1R0FBdUc7QUFDL0c7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUM2Sjs7QUFFN0oiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aW1iZXJsaW5lLWxvZ2lzdGljcy1kYXNoYm9hcmQvPzg4ZGEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL3JlZWNlc2NobGFiYWNoL0Rlc2t0b3AvVGltYmVybGluZSBJbnRlcm5hbC9hcHAvYXBpL3RydWNrbG9hZHMvW2lkXS9sYXlvdXQvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3RydWNrbG9hZHMvW2lkXS9sYXlvdXQvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS90cnVja2xvYWRzL1tpZF0vbGF5b3V0XCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS90cnVja2xvYWRzL1tpZF0vbGF5b3V0L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL3JlZWNlc2NobGFiYWNoL0Rlc2t0b3AvVGltYmVybGluZSBJbnRlcm5hbC9hcHAvYXBpL3RydWNrbG9hZHMvW2lkXS9sYXlvdXQvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0IH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvdHJ1Y2tsb2Fkcy9baWRdL2xheW91dC9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftruckloads%2F%5Bid%5D%2Flayout%2Froute&page=%2Fapi%2Ftruckloads%2F%5Bid%5D%2Flayout%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftruckloads%2F%5Bid%5D%2Flayout%2Froute.ts&appDir=%2FUsers%2Freeceschlabach%2FDesktop%2FTimberline%20Internal%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Freeceschlabach%2FDesktop%2FTimberline%20Internal&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/truckloads/[id]/layout/route.ts":
/*!*************************************************!*\
  !*** ./app/api/truckloads/[id]/layout/route.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   isValidDimension: () => (/* binding */ isValidDimension),\n/* harmony export */   isValidLayoutItem: () => (/* binding */ isValidLayoutItem),\n/* harmony export */   isValidPosition: () => (/* binding */ isValidPosition),\n/* harmony export */   validateLayout: () => (/* binding */ validateLayout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./lib/db.ts\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next-auth */ \"(rsc)/./node_modules/next-auth/index.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./lib/auth.ts\");\n\n\n\n\n// Export for testing\nfunction isValidDimension(value) {\n    return typeof value === \"number\" && value > 0;\n}\n// Export for testing\nfunction isValidPosition(value) {\n    return typeof value === \"number\" && value >= 0;\n}\n// Export for testing\nfunction isValidLayoutItem(item) {\n    if (!item || typeof item !== \"object\") {\n        console.error(\"Invalid item: not an object\", item);\n        return false;\n    }\n    // Validate type first since other validations depend on it\n    if (![\n        \"skid\",\n        \"vinyl\"\n    ].includes(item.type)) {\n        console.error(\"Invalid item: incorrect type\", item);\n        return false;\n    }\n    // Validate dimensions and positions\n    if (!isValidPosition(item.x) || !isValidPosition(item.y)) {\n        console.error(\"Invalid item: invalid position\", item);\n        return false;\n    }\n    if (!isValidDimension(item.width) || !isValidDimension(item.length)) {\n        console.error(\"Invalid item: invalid dimensions\", item);\n        return false;\n    }\n    // Validate skidId for both types\n    if (typeof item.skidId !== \"number\" || item.skidId <= 0) {\n        console.error(\"Invalid item: invalid skidId\", item);\n        return false;\n    }\n    // Validate stackId and stackPosition consistently for both types\n    if (item.stackId !== undefined) {\n        if (typeof item.stackId !== \"number\" || item.stackId <= 0) {\n            console.error(\"Invalid item: invalid stackId\", item);\n            return false;\n        }\n        // stackPosition is required if stackId is present\n        if (item.stackPosition === undefined || typeof item.stackPosition !== \"number\" || item.stackPosition <= 0) {\n            console.error(\"Invalid item: missing or invalid stackPosition for stacked item\", item);\n            return false;\n        }\n    }\n    // Validate rotation if present\n    if (item.rotation !== undefined) {\n        if (typeof item.rotation !== \"number\" || ![\n            0,\n            90,\n            180,\n            270\n        ].includes(item.rotation)) {\n            console.error(\"Invalid item: invalid rotation\", item);\n            return false;\n        }\n    }\n    // Validate customer info if present\n    if (item.customerId !== undefined) {\n        if (typeof item.customerId !== \"number\" || item.customerId <= 0) {\n            console.error(\"Invalid item: invalid customerId\", item);\n            return false;\n        }\n    }\n    if (item.customerName !== undefined && typeof item.customerName !== \"string\") {\n        console.error(\"Invalid item: invalid customerName\", item);\n        return false;\n    }\n    return true;\n}\n// Export for testing\nfunction validateLayout(layout) {\n    if (!Array.isArray(layout)) {\n        console.error(\"Invalid layout: not an array\", layout);\n        throw new Error(\"Layout must be an array\");\n    }\n    // Validate each item\n    for (const item of layout){\n        if (!isValidLayoutItem(item)) {\n            console.error(\"Invalid layout item:\", item);\n            throw new Error(`Invalid layout item: ${JSON.stringify(item)}`);\n        }\n    }\n    // Validate stack consistency\n    const stackItems = layout.filter((item)=>item.stackId !== undefined);\n    const stackGroups = new Map();\n    stackItems.forEach((item)=>{\n        if (!item.stackId) return;\n        if (!stackGroups.has(item.stackId)) {\n            stackGroups.set(item.stackId, []);\n        }\n        stackGroups.get(item.stackId)?.push(item);\n    });\n    // Check each stack\n    for (const [stackId, items] of Array.from(stackGroups.entries())){\n        // All items in a stack should have the same x,y coordinates\n        const firstItem = items[0];\n        const invalidPosition = items.some((item)=>item.x !== firstItem.x || item.y !== firstItem.y);\n        if (invalidPosition) {\n            console.error(`Stack ${stackId} has inconsistent positions:`, items);\n            throw new Error(`Stack ${stackId} has items with different positions`);\n        }\n        // Find items without a position (new items)\n        const existingItems = items.filter((item)=>item.stackPosition !== undefined);\n        const newItems = items.filter((item)=>item.stackPosition === undefined);\n        // Get the highest existing position\n        const highestPosition = existingItems.length > 0 ? Math.max(...existingItems.map((item)=>item.stackPosition || 0)) : 0;\n        // Add new items at the top of the stack with highest positions\n        newItems.forEach((item, index)=>{\n            item.stackPosition = highestPosition + index + 1;\n        });\n        // Sort all items by position in descending order (highest first)\n        const sortedItems = [\n            ...items\n        ].sort((a, b)=>{\n            const aPos = a.stackPosition || 0;\n            const bPos = b.stackPosition || 0;\n            return bPos - aPos // Sort in descending order (highest first)\n            ;\n        });\n        // Update positions to be sequential from top down\n        sortedItems.forEach((item, index)=>{\n            item.stackPosition = items.length - index // Assign highest numbers to top items\n            ;\n        });\n    }\n    return true;\n}\nasync function GET(request, { params }) {\n    try {\n        const session = await (0,next_auth__WEBPACK_IMPORTED_MODULE_2__.getServerSession)(_lib_auth__WEBPACK_IMPORTED_MODULE_3__.authOptions);\n        if (!session?.user) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            });\n        }\n        const truckloadId = parseInt(params.id);\n        if (isNaN(truckloadId)) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"Invalid truckload ID\"\n            }, {\n                status: 400\n            });\n        }\n        // Get layout type from query params\n        const searchParams = new URL(request.url).searchParams;\n        const layoutType = searchParams.get(\"type\") || \"delivery\";\n        // Ensure database connection is initialized\n        (0,_lib_db__WEBPACK_IMPORTED_MODULE_1__.getPool)();\n        console.log(\"\\uD83D\\uDD0D GET: Fetching layout for truckload:\", truckloadId, \"type:\", layoutType);\n        // Modified query to properly order by stack position\n        const result = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_1__.dbQuery)(`SELECT tli.*, \n              COALESCE(tli.stack_position, \n                ROW_NUMBER() OVER (PARTITION BY tli.stack_id ORDER BY tli.id DESC)\n              ) as stack_position\n       FROM trailer_layouts tl \n       JOIN trailer_layout_items tli ON tl.id = tli.trailer_layout_id \n       WHERE tl.truckload_id = $1 AND tl.layout_type = $2\n       ORDER BY \n         CASE \n           WHEN tli.stack_id IS NULL THEN 2\n           ELSE 1\n         END,\n         tli.stack_id,\n         tli.stack_position DESC,\n         tli.id DESC`, [\n            truckloadId,\n            layoutType\n        ]);\n        console.log(\"\\uD83D\\uDCCA GET: Raw DB results:\", result.rows);\n        // Group items by stack_id\n        const stackMap = new Map();\n        const nonStackedItems = [];\n        console.log(\"\\uD83D\\uDD04 GET: Starting first pass - organizing items into stacks\");\n        // Process each item from the database\n        for (const row of result.rows){\n            const item = {\n                skidId: row.item_id,\n                type: row.item_type,\n                x: row.x_position,\n                y: row.y_position,\n                width: row.width,\n                length: row.length,\n                rotation: row.rotation || 0,\n                customerId: row.customer_id,\n                customerName: row.customer_name,\n                stackId: row.stack_id,\n                stackPosition: row.stack_position\n            };\n            if (item.stackId) {\n                console.log(`üì¶ GET: Processing stacked item:`, {\n                    id: item.skidId,\n                    type: item.type,\n                    stackId: item.stackId,\n                    pos: item.stackPosition\n                });\n                if (!stackMap.has(item.stackId)) {\n                    stackMap.set(item.stackId, []);\n                }\n                stackMap.get(item.stackId)?.push(item);\n            } else {\n                console.log(\"\\uD83D\\uDD02 GET: Added non-stacked item:\", {\n                    id: item.skidId,\n                    type: item.type\n                });\n                nonStackedItems.push(item);\n            }\n        }\n        console.log(\"\\uD83D\\uDCCB GET: Stack map contents:\", Array.from(stackMap.entries()));\n        // Process stacks to ensure proper positioning\n        console.log(\"\\uD83D\\uDD04 GET: Starting second pass - processing stacks\");\n        stackMap.forEach((items, stackId)=>{\n            if (items.length > 0) {\n                // Sort items by stack position (highest number on top)\n                items.sort((a, b)=>(b.stackPosition || 0) - (a.stackPosition || 0));\n                // Use position of bottom item for all items in stack\n                const bottomItem = items[items.length - 1];\n                items.forEach((item)=>{\n                    item.x = bottomItem.x;\n                    item.y = bottomItem.y;\n                });\n                console.log(`üìö Stack ${stackId} processed:`, items.map((i)=>({\n                        id: i.skidId,\n                        type: i.type,\n                        pos: i.stackPosition,\n                        x: i.x,\n                        y: i.y\n                    })));\n            }\n        });\n        // Combine all items for response\n        const layout = [\n            ...nonStackedItems,\n            ...Array.from(stackMap.values()).flat()\n        ];\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: true,\n            layout\n        });\n    } catch (error) {\n        console.error(\"‚ùå GET: Error:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: false,\n            error: error instanceof Error ? error.message : \"An error occurred\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function POST(request, { params }) {\n    const client = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_1__.getClient)();\n    try {\n        const truckloadId = params.id;\n        const body = await request.json();\n        // Get layout type from query params\n        const searchParams = new URL(request.url).searchParams;\n        const layoutType = searchParams.get(\"type\") || \"delivery\";\n        console.log(\"\\uD83D\\uDCE5 POST: Received layout save request for truckload:\", truckloadId, \"type:\", layoutType);\n        const session = await (0,next_auth__WEBPACK_IMPORTED_MODULE_2__.getServerSession)(_lib_auth__WEBPACK_IMPORTED_MODULE_3__.authOptions);\n        if (!session?.user) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            });\n        }\n        if (isNaN(parseInt(truckloadId))) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: \"Invalid truckload ID\"\n            }, {\n                status: 400\n            });\n        }\n        try {\n            validateLayout(body.layout);\n        } catch (error) {\n            console.error(\"‚ùå POST: Layout validation error:\", error);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                success: false,\n                error: error instanceof Error ? error.message : \"Invalid layout data\"\n            }, {\n                status: 400\n            });\n        }\n        // Start transaction\n        await client.query(\"BEGIN\");\n        console.log(\"\\uD83D\\uDD04 POST: Started database transaction\");\n        // Get or create layout ID\n        const layoutResult = await client.query(`SELECT id FROM trailer_layouts WHERE truckload_id = $1 AND layout_type = $2`, [\n            truckloadId,\n            layoutType\n        ]);\n        let layoutId;\n        if (layoutResult.rows.length === 0) {\n            console.log(\"\\uD83D\\uDCDD POST: Creating new layout for truckload:\", truckloadId, \"type:\", layoutType);\n            const newLayoutResult = await client.query(`INSERT INTO trailer_layouts (truckload_id, layout_type) VALUES ($1, $2) RETURNING id`, [\n                truckloadId,\n                layoutType\n            ]);\n            layoutId = newLayoutResult.rows[0].id;\n            console.log(\"‚úÖ POST: Created new layout with ID:\", layoutId);\n        } else {\n            layoutId = layoutResult.rows[0].id;\n            console.log(\"\\uD83D\\uDCCB POST: Using existing layout with ID:\", layoutId);\n        }\n        // Delete existing layout items\n        await client.query(`DELETE FROM trailer_layout_items WHERE trailer_layout_id = $1`, [\n            layoutId\n        ]);\n        console.log(\"\\uD83D\\uDDD1Ô∏è POST: Deleted existing layout items\");\n        // Group items by stack for ordered insertion\n        const stackMap = new Map();\n        const nonStackedItems = [];\n        console.log(\"\\uD83D\\uDD04 POST: Grouping items by stack\");\n        body.layout.forEach((item)=>{\n            if (item.stackId !== undefined) {\n                const stack = stackMap.get(item.stackId) || [];\n                stack.push(item);\n                stackMap.set(item.stackId, stack);\n                console.log(`üìö POST: Added item to stack ${item.stackId}:`, {\n                    id: item.skidId,\n                    type: item.type,\n                    pos: item.stackPosition\n                });\n            } else {\n                nonStackedItems.push(item);\n                console.log(\"\\uD83D\\uDD02 POST: Added non-stacked item:\", {\n                    id: item.skidId,\n                    type: item.type\n                });\n            }\n        });\n        // Process and insert non-stacked items\n        console.log(\"\\uD83D\\uDCDD POST: Inserting non-stacked items\");\n        for (const item of nonStackedItems){\n            await client.query(`INSERT INTO trailer_layout_items (\n          trailer_layout_id,\n          item_type,\n          item_id,\n          x_position,\n          y_position,\n          width,\n          length,\n          rotation,\n          customer_id,\n          customer_name,\n          stack_id,\n          stack_position\n        ) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)`, [\n                layoutId,\n                item.type,\n                item.skidId,\n                item.x,\n                item.y,\n                item.width,\n                item.length,\n                item.rotation || 0,\n                item.customerId,\n                item.customerName,\n                null,\n                null\n            ]);\n            console.log(\"‚úÖ POST: Inserted non-stacked item:\", {\n                id: item.skidId,\n                type: item.type\n            });\n        }\n        // Process and insert stacked items\n        console.log(\"\\uD83D\\uDCDD POST: Processing stacks\");\n        for (const [stackId, items] of Array.from(stackMap)){\n            console.log(`üîÑ POST: Processing stack ${stackId} with ${items.length} items`);\n            // Sort items by stack position (highest number on top)\n            items.sort((a, b)=>(b.stackPosition || 0) - (a.stackPosition || 0));\n            // Use the bottom item's position for the entire stack\n            const bottomItem = items[items.length - 1];\n            const stackX = bottomItem.x;\n            const stackY = bottomItem.y;\n            // Insert items in order (from bottom to top)\n            for(let i = items.length - 1; i >= 0; i--){\n                const item = items[i];\n                const stackPosition = items.length - i // Position 1 is bottom\n                ;\n                console.log(`üì¶ POST: Inserting stack item:`, {\n                    id: item.skidId,\n                    type: item.type,\n                    stackId,\n                    position: stackPosition,\n                    x: stackX,\n                    y: stackY\n                });\n                await client.query(`INSERT INTO trailer_layout_items (\n            trailer_layout_id,\n            item_type,\n            item_id,\n            x_position,\n            y_position,\n            width,\n            length,\n            rotation,\n            customer_id,\n            customer_name,\n            stack_id,\n            stack_position\n          ) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12)`, [\n                    layoutId,\n                    item.type,\n                    item.skidId,\n                    stackX,\n                    stackY,\n                    item.width,\n                    item.length,\n                    item.rotation || 0,\n                    item.customerId,\n                    item.customerName,\n                    stackId,\n                    stackPosition\n                ]);\n            }\n            console.log(`‚úÖ POST: Completed stack ${stackId} insertion`);\n        }\n        // Commit transaction\n        await client.query(\"COMMIT\");\n        console.log(\"‚úÖ POST: Transaction committed successfully\");\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: true\n        });\n    } catch (error) {\n        console.error(\"‚ùå POST: Error:\", error);\n        try {\n            await client.query(\"ROLLBACK\");\n            console.log(\"\\uD83D\\uDD04 POST: Transaction rolled back\");\n        } catch (rollbackError) {\n            console.error(\"‚ùå POST: Error during rollback:\", rollbackError);\n        }\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: false,\n            error: error instanceof Error ? error.message : \"An error occurred\"\n        }, {\n            status: 500\n        });\n    } finally{\n        client.release();\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3RydWNrbG9hZHMvW2lkXS9sYXlvdXQvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBdUQ7QUFDRDtBQUNWO0FBQ0o7QUFvQnhDLHFCQUFxQjtBQUNkLFNBQVNNLGlCQUFpQkMsS0FBYztJQUM3QyxPQUFPLE9BQU9BLFVBQVUsWUFBWUEsUUFBUTtBQUM5QztBQUVBLHFCQUFxQjtBQUNkLFNBQVNDLGdCQUFnQkQsS0FBYztJQUM1QyxPQUFPLE9BQU9BLFVBQVUsWUFBWUEsU0FBUztBQUMvQztBQUVBLHFCQUFxQjtBQUNkLFNBQVNFLGtCQUFrQkMsSUFBUztJQUN6QyxJQUFJLENBQUNBLFFBQVEsT0FBT0EsU0FBUyxVQUFVO1FBQ3JDQyxRQUFRQyxLQUFLLENBQUMsK0JBQStCRjtRQUM3QyxPQUFPO0lBQ1Q7SUFFQSwyREFBMkQ7SUFDM0QsSUFBSSxDQUFDO1FBQUM7UUFBUTtLQUFRLENBQUNHLFFBQVEsQ0FBQ0gsS0FBS0ksSUFBSSxHQUFHO1FBQzFDSCxRQUFRQyxLQUFLLENBQUMsZ0NBQWdDRjtRQUM5QyxPQUFPO0lBQ1Q7SUFFQSxvQ0FBb0M7SUFDcEMsSUFBSSxDQUFDRixnQkFBZ0JFLEtBQUtLLENBQUMsS0FBSyxDQUFDUCxnQkFBZ0JFLEtBQUtNLENBQUMsR0FBRztRQUN4REwsUUFBUUMsS0FBSyxDQUFDLGtDQUFrQ0Y7UUFDaEQsT0FBTztJQUNUO0lBQ0EsSUFBSSxDQUFDSixpQkFBaUJJLEtBQUtPLEtBQUssS0FBSyxDQUFDWCxpQkFBaUJJLEtBQUtRLE1BQU0sR0FBRztRQUNuRVAsUUFBUUMsS0FBSyxDQUFDLG9DQUFvQ0Y7UUFDbEQsT0FBTztJQUNUO0lBRUEsaUNBQWlDO0lBQ2pDLElBQUksT0FBT0EsS0FBS1MsTUFBTSxLQUFLLFlBQVlULEtBQUtTLE1BQU0sSUFBSSxHQUFHO1FBQ3ZEUixRQUFRQyxLQUFLLENBQUMsZ0NBQWdDRjtRQUM5QyxPQUFPO0lBQ1Q7SUFFQSxpRUFBaUU7SUFDakUsSUFB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WUFDdkJDLFNBQVM7WUFDVHZELE9BQU9BLGlCQUFpQmtCLFFBQVFsQixNQUFNb0YsT0FBTyxHQUFHO1FBQ2xELEdBQUc7WUFBRTVCLFFBQVE7UUFBSTtJQUNuQixTQUFVO1FBQ1I4QixPQUFPVyxPQUFPO0lBQ2hCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aW1iZXJsaW5lLWxvZ2lzdGljcy1kYXNoYm9hcmQvLi9hcHAvYXBpL3RydWNrbG9hZHMvW2lkXS9sYXlvdXQvcm91dGUudHM/OWMzMyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQgeyBkYlF1ZXJ5LCBnZXRQb29sLCBnZXRDbGllbnQgfSBmcm9tICdAL2xpYi9kYidcbmltcG9ydCB7IGdldFNlcnZlclNlc3Npb24gfSBmcm9tICduZXh0LWF1dGgnXG5pbXBvcnQgeyBhdXRoT3B0aW9ucyB9IGZyb20gJ0AvbGliL2F1dGgnXG5cbmludGVyZmFjZSBMYXlvdXRJdGVtIHtcbiAgc2tpZElkPzogbnVtYmVyIHwgbnVsbFxuICB4OiBudW1iZXJcbiAgeTogbnVtYmVyXG4gIHdpZHRoOiBudW1iZXJcbiAgbGVuZ3RoOiBudW1iZXJcbiAgdHlwZTogJ3NraWQnIHwgJ3ZpbnlsJ1xuICByb3RhdGlvbj86IG51bWJlclxuICBjdXN0b21lcklkPzogbnVtYmVyXG4gIGN1c3RvbWVyTmFtZT86IHN0cmluZ1xuICBzdGFja0lkPzogbnVtYmVyXG4gIHN0YWNrUG9zaXRpb24/OiBudW1iZXJcbn1cblxuaW50ZXJmYWNlIFNhdmVMYXlvdXRSZXF1ZXN0IHtcbiAgbGF5b3V0OiBMYXlvdXRJdGVtW11cbn1cblxuLy8gRXhwb3J0IGZvciB0ZXN0aW5nXG5leHBvcnQgZnVuY3Rpb24gaXNWYWxpZERpbWVuc2lvbih2YWx1ZTogdW5rbm93bik6IHZhbHVlIGlzIG51bWJlciB7XG4gIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmIHZhbHVlID4gMFxufVxuXG4vLyBFeHBvcnQgZm9yIHRlc3RpbmdcbmV4cG9ydCBmdW5jdGlvbiBpc1ZhbGlkUG9zaXRpb24odmFsdWU6IHVua25vd24pOiB2YWx1ZSBpcyBudW1iZXIge1xuICByZXR1cm4gdHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyAmJiB2YWx1ZSA+PSAwXG59XG5cbi8vIEV4cG9ydCBmb3IgdGVzdGluZ1xuZXhwb3J0IGZ1bmN0aW9uIGlzVmFsaWRMYXlvdXRJdGVtKGl0ZW06IGFueSk6IGl0ZW0gaXMgTGF5b3V0SXRlbSB7XG4gIGlmICghaXRlbSB8fCB0eXBlb2YgaXRlbSAhPT0gJ29iamVjdCcpIHtcbiAgICBjb25zb2xlLmVycm9yKCdJbnZhbGlkIGl0ZW06IG5vdCBhbiBvYmplY3QnLCBpdGVtKVxuICAgIHJldHVybiBmYWxzZVxuICB9XG5cbiAgLy8gVmFsaWRhdGUgdHlwZSBmaXJzdCBzaW5jZSBvdGhlciB2YWxpZGF0aW9ucyBkZXBlbmQgb24gaXRcbiAgaWYgKCFbJ3NraWQnLCAndmlueWwnXS5pbmNsdWRlcyhpdGVtLnR5cGUpKSB7XG4gICAgY29uc29sZS5lcnJvcignSW52YWxpZCBpdGVtOiBpbmNvcnJlY3QgdHlwZScsIGl0ZW0pXG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cblxuICAvLyBWYWxpZGF0ZSBkaW1lbnNpb25zIGFuZCBwb3NpdGlvbnNcbiAgaWYgKCFpc1ZhbGlkUG9zaXRpb24oaXRlbS54KSB8fCAhaXNWYWxpZFBvc2l0aW9uKGl0ZW0ueSkpIHtcbiAgICBjb25zb2xlLmVycm9yKCdJbnZhbGlkIGl0ZW06IGludmFsaWQgcG9zaXRpb24nLCBpdGVtKVxuICAgIHJldHVybiBmYWxzZVxuICB9XG4gIGlmICghaXNWYWxpZERpbWVuc2lvbihpdGVtLndpZHRoKSB8fCAhaXNWYWxpZERpbWVuc2lvbihpdGVtLmxlbmd0aCkpIHtcbiAgICBjb25zb2xlLmVycm9yKCdJbnZhbGlkIGl0ZW06IGludmFsaWQgZGltZW5zaW9ucycsIGl0ZW0pXG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cblxuICAvLyBWYWxpZGF0ZSBza2lkSWQgZm9yIGJvdGggdHlwZXNcbiAgaWYgKHR5cGVvZiBpdGVtLnNraWRJZCAhPT0gJ251bWJlcicgfHwgaXRlbS5za2lkSWQgPD0gMCkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0ludmFsaWQgaXRlbTogaW52YWxpZCBza2lkSWQnLCBpdGVtKVxuICAgIHJldHVybiBmYWxzZVxuICB9XG5cbiAgLy8gVmFsaWRhdGUgc3RhY2tJZCBhbmQgc3RhY2tQb3NpdGlvbiBjb25zaXN0ZW50bHkgZm9yIGJvdGggdHlwZXNcbiAgaWYgKGl0ZW0uc3RhY2tJZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgaWYgKHR5cGVvZiBpdGVtLnN0YWNrSWQgIT09ICdudW1iZXInIHx8IGl0ZW0uc3RhY2tJZCA8PSAwKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdJbnZhbGlkIGl0ZW06IGludmFsaWQgc3RhY2tJZCcsIGl0ZW0pXG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gICAgLy8gc3RhY2tQb3NpdGlvbiBpcyByZXF1aXJlZCBpZiBzdGFja0lkIGlzIHByZXNlbnRcbiAgICBpZiAoaXRlbS5zdGFja1Bvc2l0aW9uID09PSB1bmRlZmluZWQgfHwgdHlwZW9mIGl0ZW0uc3RhY2tQb3NpdGlvbiAhPT0gJ251bWJlcicgfHwgaXRlbS5zdGFja1Bvc2l0aW9uIDw9IDApIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ludmFsaWQgaXRlbTogbWlzc2luZyBvciBpbnZhbGlkIHN0YWNrUG9zaXRpb24gZm9yIHN0YWNrZWQgaXRlbScsIGl0ZW0pXG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gIH1cblxuICAvLyBWYWxpZGF0ZSByb3RhdGlvbiBpZiBwcmVzZW50XG4gIGlmIChpdGVtLnJvdGF0aW9uICE9PSB1bmRlZmluZWQpIHtcbiAgICBpZiAodHlwZW9mIGl0ZW0ucm90YXRpb24gIT09ICdudW1iZXInIHx8ICFbMCwgOTAsIDE4MCwgMjcwXS5pbmNsdWRlcyhpdGVtLnJvdGF0aW9uKSkge1xuICAgICAgY29uc29sZS5lcnJvcignSW52YWxpZCBpdGVtOiBpbnZhbGlkIHJvdGF0aW9uJywgaXRlbSlcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgfVxuXG4gIC8vIFZhbGlkYXRlIGN1c3RvbWVyIGluZm8gaWYgcHJlc2VudFxuICBpZiAoaXRlbS5jdXN0b21lcklkICE9PSB1bmRlZmluZWQpIHtcbiAgICBpZiAodHlwZW9mIGl0ZW0uY3VzdG9tZXJJZCAhPT0gJ251bWJlcicgfHwgaXRlbS5jdXN0b21lcklkIDw9IDApIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ludmFsaWQgaXRlbTogaW52YWxpZCBjdXN0b21lcklkJywgaXRlbSlcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgfVxuICBpZiAoaXRlbS5jdXN0b21lck5hbWUgIT09IHVuZGVmaW5lZCAmJiB0eXBlb2YgaXRlbS5jdXN0b21lck5hbWUgIT09ICdzdHJpbmcnKSB7XG4gICAgY29uc29sZS5lcnJvcignSW52YWxpZCBpdGVtOiBpbnZhbGlkIGN1c3RvbWVyTmFtZScsIGl0ZW0pXG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cblxuICByZXR1cm4gdHJ1ZVxufVxuXG4vLyBFeHBvcnQgZm9yIHRlc3RpbmdcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZUxheW91dChsYXlvdXQ6IHVua25vd24pOiBsYXlvdXQgaXMgTGF5b3V0SXRlbVtdIHtcbiAgaWYgKCFBcnJheS5pc0FycmF5KGxheW91dCkpIHtcbiAgICBjb25zb2xlLmVycm9yKCdJbnZhbGlkIGxheW91dDogbm90IGFuIGFycmF5JywgbGF5b3V0KVxuICAgIHRocm93IG5ldyBFcnJvcignTGF5b3V0IG11c3QgYmUgYW4gYXJyYXknKVxuICB9XG5cbiAgLy8gVmFsaWRhdGUgZWFjaCBpdGVtXG4gIGZvciAoY29uc3QgaXRlbSBvZiBsYXlvdXQpIHtcbiAgICBpZiAoIWlzVmFsaWRMYXlvdXRJdGVtKGl0ZW0pKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdJbnZhbGlkIGxheW91dCBpdGVtOicsIGl0ZW0pXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgbGF5b3V0IGl0ZW06ICR7SlNPTi5zdHJpbmdpZnkoaXRlbSl9YClcbiAgICB9XG4gIH1cblxuICAvLyBWYWxpZGF0ZSBzdGFjayBjb25zaXN0ZW5jeVxuICBjb25zdCBzdGFja0l0ZW1zID0gbGF5b3V0LmZpbHRlcihpdGVtID0+IGl0ZW0uc3RhY2tJZCAhPT0gdW5kZWZpbmVkKVxuICBjb25zdCBzdGFja0dyb3VwcyA9IG5ldyBNYXA8bnVtYmVyLCBMYXlvdXRJdGVtW10+KClcbiAgXG4gIHN0YWNrSXRlbXMuZm9yRWFjaCgoaXRlbTogTGF5b3V0SXRlbSkgPT4ge1xuICAgIGlmICghaXRlbS5zdGFja0lkKSByZXR1cm5cbiAgICBpZiAoIXN0YWNrR3JvdXBzLmhhcyhpdGVtLnN0YWNrSWQpKSB7XG4gICAgICBzdGFja0dyb3Vwcy5zZXQoaXRlbS5zdGFja0lkLCBbXSlcbiAgICB9XG4gICAgc3RhY2tHcm91cHMuZ2V0KGl0ZW0uc3RhY2tJZCk/LnB1c2goaXRlbSlcbiAgfSlcblxuICAvLyBDaGVjayBlYWNoIHN0YWNrXG4gIGZvciAoY29uc3QgW3N0YWNrSWQsIGl0ZW1zXSBvZiBBcnJheS5mcm9tKHN0YWNrR3JvdXBzLmVudHJpZXMoKSkpIHtcbiAgICAvLyBBbGwgaXRlbXMgaW4gYSBzdGFjayBzaG91bGQgaGF2ZSB0aGUgc2FtZSB4LHkgY29vcmRpbmF0ZXNcbiAgICBjb25zdCBmaXJzdEl0ZW0gPSBpdGVtc1swXVxuICAgIGNvbnN0IGludmFsaWRQb3NpdGlvbiA9IGl0ZW1zLnNvbWUoKGl0ZW06IExheW91dEl0ZW0pID0+IFxuICAgICAgaXRlbS54ICE9PSBmaXJzdEl0ZW0ueCB8fCBpdGVtLnkgIT09IGZpcnN0SXRlbS55XG4gICAgKVxuICAgIGlmIChpbnZhbGlkUG9zaXRpb24pIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYFN0YWNrICR7c3RhY2tJZH0gaGFzIGluY29uc2lzdGVudCBwb3NpdGlvbnM6YCwgaXRlbXMpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFN0YWNrICR7c3RhY2tJZH0gaGFzIGl0ZW1zIHdpdGggZGlmZmVyZW50IHBvc2l0aW9uc2ApXG4gICAgfVxuXG4gICAgLy8gRmluZCBpdGVtcyB3aXRob3V0IGEgcG9zaXRpb24gKG5ldyBpdGVtcylcbiAgICBjb25zdCBleGlzdGluZ0l0ZW1zID0gaXRlbXMuZmlsdGVyKGl0ZW0gPT4gaXRlbS5zdGFja1Bvc2l0aW9uICE9PSB1bmRlZmluZWQpXG4gICAgY29uc3QgbmV3SXRlbXMgPSBpdGVtcy5maWx0ZXIoaXRlbSA9PiBpdGVtLnN0YWNrUG9zaXRpb24gPT09IHVuZGVmaW5lZClcblxuICAgIC8vIEdldCB0aGUgaGlnaGVzdCBleGlzdGluZyBwb3NpdGlvblxuICAgIGNvbnN0IGhpZ2hlc3RQb3NpdGlvbiA9IGV4aXN0aW5nSXRlbXMubGVuZ3RoID4gMCBcbiAgICAgID8gTWF0aC5tYXgoLi4uZXhpc3RpbmdJdGVtcy5tYXAoaXRlbSA9PiBpdGVtLnN0YWNrUG9zaXRpb24gfHwgMCkpXG4gICAgICA6IDBcblxuICAgIC8vIEFkZCBuZXcgaXRlbXMgYXQgdGhlIHRvcCBvZiB0aGUgc3RhY2sgd2l0aCBoaWdoZXN0IHBvc2l0aW9uc1xuICAgIG5ld0l0ZW1zLmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7XG4gICAgICBpdGVtLnN0YWNrUG9zaXRpb24gPSBoaWdoZXN0UG9zaXRpb24gKyBpbmRleCArIDFcbiAgICB9KVxuXG4gICAgLy8gU29ydCBhbGwgaXRlbXMgYnkgcG9zaXRpb24gaW4gZGVzY2VuZGluZyBvcmRlciAoaGlnaGVzdCBmaXJzdClcbiAgICBjb25zdCBzb3J0ZWRJdGVtcyA9IFsuLi5pdGVtc10uc29ydCgoYSwgYikgPT4ge1xuICAgICAgY29uc3QgYVBvcyA9IGEuc3RhY2tQb3NpdGlvbiB8fCAwXG4gICAgICBjb25zdCBiUG9zID0gYi5zdGFja1Bvc2l0aW9uIHx8IDBcbiAgICAgIHJldHVybiBiUG9zIC0gYVBvcyAvLyBTb3J0IGluIGRlc2NlbmRpbmcgb3JkZXIgKGhpZ2hlc3QgZmlyc3QpXG4gICAgfSlcblxuICAgIC8vIFVwZGF0ZSBwb3NpdGlvbnMgdG8gYmUgc2VxdWVudGlhbCBmcm9tIHRvcCBkb3duXG4gICAgc29ydGVkSXRlbXMuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHtcbiAgICAgIGl0ZW0uc3RhY2tQb3NpdGlvbiA9IGl0ZW1zLmxlbmd0aCAtIGluZGV4IC8vIEFzc2lnbiBoaWdoZXN0IG51bWJlcnMgdG8gdG9wIGl0ZW1zXG4gICAgfSlcbiAgfVxuXG4gIHJldHVybiB0cnVlXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQoXG4gIHJlcXVlc3Q6IE5leHRSZXF1ZXN0LFxuICB7IHBhcmFtcyB9OiB7IHBhcmFtczogeyBpZDogc3RyaW5nIH0gfVxuKSB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlcnZlclNlc3Npb24oYXV0aE9wdGlvbnMpXG4gICAgaWYgKCFzZXNzaW9uPy51c2VyKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSlcbiAgICB9XG5cbiAgICBjb25zdCB0cnVja2xvYWRJZCA9IHBhcnNlSW50KHBhcmFtcy5pZClcbiAgICBpZiAoaXNOYU4odHJ1Y2tsb2FkSWQpKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdJbnZhbGlkIHRydWNrbG9hZCBJRCcgfSwgeyBzdGF0dXM6IDQwMCB9KVxuICAgIH1cblxuICAgIC8vIEdldCBsYXlvdXQgdHlwZSBmcm9tIHF1ZXJ5IHBhcmFtc1xuICAgIGNvbnN0IHNlYXJjaFBhcmFtcyA9IG5ldyBVUkwocmVxdWVzdC51cmwpLnNlYXJjaFBhcmFtc1xuICAgIGNvbnN0IGxheW91dFR5cGUgPSBzZWFyY2hQYXJhbXMuZ2V0KCd0eXBlJykgfHwgJ2RlbGl2ZXJ5J1xuXG4gICAgLy8gRW5zdXJlIGRhdGFiYXNlIGNvbm5lY3Rpb24gaXMgaW5pdGlhbGl6ZWRcbiAgICBnZXRQb29sKClcblxuICAgIGNvbnNvbGUubG9nKCfwn5SNIEdFVDogRmV0Y2hpbmcgbGF5b3V0IGZvciB0cnVja2xvYWQ6JywgdHJ1Y2tsb2FkSWQsICd0eXBlOicsIGxheW91dFR5cGUpXG5cbiAgICAvLyBNb2RpZmllZCBxdWVyeSB0byBwcm9wZXJseSBvcmRlciBieSBzdGFjayBwb3NpdGlvblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiUXVlcnkoXG4gICAgICBgU0VMRUNUIHRsaS4qLCBcbiAgICAgICAgICAgICAgQ09BTEVTQ0UodGxpLnN0YWNrX3Bvc2l0aW9uLCBcbiAgICAgICAgICAgICAgICBST1dfTlVNQkVSKCkgT1ZFUiAoUEFSVElUSU9OIEJZIHRsaS5zdGFja19pZCBPUkRFUiBCWSB0bGkuaWQgREVTQylcbiAgICAgICAgICAgICAgKSBhcyBzdGFja19wb3NpdGlvblxuICAgICAgIEZST00gdHJhaWxlcl9sYXlvdXRzIHRsIFxuICAgICAgIEpPSU4gdHJhaWxlcl9sYXlvdXRfaXRlbXMgdGxpIE9OIHRsLmlkID0gdGxpLnRyYWlsZXJfbGF5b3V0X2lkIFxuICAgICAgIFdIRVJFIHRsLnRydWNrbG9hZF9pZCA9ICQxIEFORCB0bC5sYXlvdXRfdHlwZSA9ICQyXG4gICAgICAgT1JERVIgQlkgXG4gICAgICAgICBDQVNFIFxuICAgICAgICAgICBXSEVOIHRsaS5zdGFja19pZCBJUyBOVUxMIFRIRU4gMlxuICAgICAgICAgICBFTFNFIDFcbiAgICAgICAgIEVORCxcbiAgICAgICAgIHRsaS5zdGFja19pZCxcbiAgICAgICAgIHRsaS5zdGFja19wb3NpdGlvbiBERVNDLFxuICAgICAgICAgdGxpLmlkIERFU0NgLFxuICAgICAgW3RydWNrbG9hZElkLCBsYXlvdXRUeXBlXVxuICAgIClcblxuICAgIGNvbnNvbGUubG9nKCfwn5OKIEdFVDogUmF3IERCIHJlc3VsdHM6JywgcmVzdWx0LnJvd3MpXG5cbiAgICAvLyBHcm91cCBpdGVtcyBieSBzdGFja19pZFxuICAgIGNvbnN0IHN0YWNrTWFwID0gbmV3IE1hcDxudW1iZXIsIExheW91dEl0ZW1bXT4oKVxuICAgIGNvbnN0IG5vblN0YWNrZWRJdGVtczogTGF5b3V0SXRlbVtdID0gW11cblxuICAgIGNvbnNvbGUubG9nKCfwn5SEIEdFVDogU3RhcnRpbmcgZmlyc3QgcGFzcyAtIG9yZ2FuaXppbmcgaXRlbXMgaW50byBzdGFja3MnKVxuICAgIFxuICAgIC8vIFByb2Nlc3MgZWFjaCBpdGVtIGZyb20gdGhlIGRhdGFiYXNlXG4gICAgZm9yIChjb25zdCByb3cgb2YgcmVzdWx0LnJvd3MpIHtcbiAgICAgIGNvbnN0IGl0ZW06IExheW91dEl0ZW0gPSB7XG4gICAgICAgIHNraWRJZDogcm93Lml0ZW1faWQsXG4gICAgICAgIHR5cGU6IHJvdy5pdGVtX3R5cGUsXG4gICAgICAgIHg6IHJvdy54X3Bvc2l0aW9uLFxuICAgICAgICB5OiByb3cueV9wb3NpdGlvbixcbiAgICAgICAgd2lkdGg6IHJvdy53aWR0aCxcbiAgICAgICAgbGVuZ3RoOiByb3cubGVuZ3RoLFxuICAgICAgICByb3RhdGlvbjogcm93LnJvdGF0aW9uIHx8IDAsXG4gICAgICAgIGN1c3RvbWVySWQ6IHJvdy5jdXN0b21lcl9pZCxcbiAgICAgICAgY3VzdG9tZXJOYW1lOiByb3cuY3VzdG9tZXJfbmFtZSxcbiAgICAgICAgc3RhY2tJZDogcm93LnN0YWNrX2lkLFxuICAgICAgICBzdGFja1Bvc2l0aW9uOiByb3cuc3RhY2tfcG9zaXRpb25cbiAgICAgIH1cblxuICAgICAgaWYgKGl0ZW0uc3RhY2tJZCkge1xuICAgICAgICBjb25zb2xlLmxvZyhg8J+TpiBHRVQ6IFByb2Nlc3Npbmcgc3RhY2tlZCBpdGVtOmAsIHtcbiAgICAgICAgICBpZDogaXRlbS5za2lkSWQsXG4gICAgICAgICAgdHlwZTogaXRlbS50eXBlLFxuICAgICAgICAgIHN0YWNrSWQ6IGl0ZW0uc3RhY2tJZCxcbiAgICAgICAgICBwb3M6IGl0ZW0uc3RhY2tQb3NpdGlvblxuICAgICAgICB9KVxuICAgICAgICBcbiAgICAgICAgaWYgKCFzdGFja01hcC5oYXMoaXRlbS5zdGFja0lkKSkge1xuICAgICAgICAgIHN0YWNrTWFwLnNldChpdGVtLnN0YWNrSWQsIFtdKVxuICAgICAgICB9XG4gICAgICAgIHN0YWNrTWFwLmdldChpdGVtLnN0YWNrSWQpPy5wdXNoKGl0ZW0pXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZygn8J+UgiBHRVQ6IEFkZGVkIG5vbi1zdGFja2VkIGl0ZW06Jywge1xuICAgICAgICAgIGlkOiBpdGVtLnNraWRJZCxcbiAgICAgICAgICB0eXBlOiBpdGVtLnR5cGVcbiAgICAgICAgfSlcbiAgICAgICAgbm9uU3RhY2tlZEl0ZW1zLnB1c2goaXRlbSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZygn8J+TiyBHRVQ6IFN0YWNrIG1hcCBjb250ZW50czonLCBBcnJheS5mcm9tKHN0YWNrTWFwLmVudHJpZXMoKSkpXG5cbiAgICAvLyBQcm9jZXNzIHN0YWNrcyB0byBlbnN1cmUgcHJvcGVyIHBvc2l0aW9uaW5nXG4gICAgY29uc29sZS5sb2coJ/CflIQgR0VUOiBTdGFydGluZyBzZWNvbmQgcGFzcyAtIHByb2Nlc3Npbmcgc3RhY2tzJylcbiAgICBzdGFja01hcC5mb3JFYWNoKChpdGVtcywgc3RhY2tJZCkgPT4ge1xuICAgICAgaWYgKGl0ZW1zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgLy8gU29ydCBpdGVtcyBieSBzdGFjayBwb3NpdGlvbiAoaGlnaGVzdCBudW1iZXIgb24gdG9wKVxuICAgICAgICBpdGVtcy5zb3J0KChhOiBMYXlvdXRJdGVtLCBiOiBMYXlvdXRJdGVtKSA9PiAoYi5zdGFja1Bvc2l0aW9uIHx8IDApIC0gKGEuc3RhY2tQb3NpdGlvbiB8fCAwKSlcbiAgICAgICAgXG4gICAgICAgIC8vIFVzZSBwb3NpdGlvbiBvZiBib3R0b20gaXRlbSBmb3IgYWxsIGl0ZW1zIGluIHN0YWNrXG4gICAgICAgIGNvbnN0IGJvdHRvbUl0ZW0gPSBpdGVtc1tpdGVtcy5sZW5ndGggLSAxXVxuICAgICAgICBpdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICAgIGl0ZW0ueCA9IGJvdHRvbUl0ZW0ueFxuICAgICAgICAgIGl0ZW0ueSA9IGJvdHRvbUl0ZW0ueVxuICAgICAgICB9KVxuICAgICAgICBcbiAgICAgICAgY29uc29sZS5sb2coYPCfk5ogU3RhY2sgJHtzdGFja0lkfSBwcm9jZXNzZWQ6YCwgaXRlbXMubWFwKGkgPT4gKHtcbiAgICAgICAgICBpZDogaS5za2lkSWQsXG4gICAgICAgICAgdHlwZTogaS50eXBlLFxuICAgICAgICAgIHBvczogaS5zdGFja1Bvc2l0aW9uLFxuICAgICAgICAgIHg6IGkueCxcbiAgICAgICAgICB5OiBpLnlcbiAgICAgICAgfSkpKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICAvLyBDb21iaW5lIGFsbCBpdGVtcyBmb3IgcmVzcG9uc2VcbiAgICBjb25zdCBsYXlvdXQgPSBbXG4gICAgICAuLi5ub25TdGFja2VkSXRlbXMsXG4gICAgICAuLi5BcnJheS5mcm9tKHN0YWNrTWFwLnZhbHVlcygpKS5mbGF0KClcbiAgICBdXG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGxheW91dFxuICAgIH0pXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign4p2MIEdFVDogRXJyb3I6JywgZXJyb3IpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICBzdWNjZXNzOiBmYWxzZSwgXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnQW4gZXJyb3Igb2NjdXJyZWQnIFxuICAgIH0sIHsgc3RhdHVzOiA1MDAgfSlcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChcbiAgcmVxdWVzdDogTmV4dFJlcXVlc3QsXG4gIHsgcGFyYW1zIH06IHsgcGFyYW1zOiB7IGlkOiBzdHJpbmcgfSB9XG4pIHtcbiAgY29uc3QgY2xpZW50ID0gYXdhaXQgZ2V0Q2xpZW50KClcbiAgXG4gIHRyeSB7XG4gICAgY29uc3QgdHJ1Y2tsb2FkSWQgPSBwYXJhbXMuaWRcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKClcbiAgICBcbiAgICAvLyBHZXQgbGF5b3V0IHR5cGUgZnJvbSBxdWVyeSBwYXJhbXNcbiAgICBjb25zdCBzZWFyY2hQYXJhbXMgPSBuZXcgVVJMKHJlcXVlc3QudXJsKS5zZWFyY2hQYXJhbXNcbiAgICBjb25zdCBsYXlvdXRUeXBlID0gc2VhcmNoUGFyYW1zLmdldCgndHlwZScpIHx8ICdkZWxpdmVyeSdcbiAgICBcbiAgICBjb25zb2xlLmxvZygn8J+TpSBQT1NUOiBSZWNlaXZlZCBsYXlvdXQgc2F2ZSByZXF1ZXN0IGZvciB0cnVja2xvYWQ6JywgdHJ1Y2tsb2FkSWQsICd0eXBlOicsIGxheW91dFR5cGUpXG4gICAgXG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlcnZlclNlc3Npb24oYXV0aE9wdGlvbnMpXG4gICAgaWYgKCFzZXNzaW9uPy51c2VyKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0sIHsgc3RhdHVzOiA0MDEgfSlcbiAgICB9XG5cbiAgICBpZiAoaXNOYU4ocGFyc2VJbnQodHJ1Y2tsb2FkSWQpKSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW52YWxpZCB0cnVja2xvYWQgSUQnIH0sIHsgc3RhdHVzOiA0MDAgfSlcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgdmFsaWRhdGVMYXlvdXQoYm9keS5sYXlvdXQpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBQT1NUOiBMYXlvdXQgdmFsaWRhdGlvbiBlcnJvcjonLCBlcnJvcilcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxuICAgICAgICBzdWNjZXNzOiBmYWxzZSwgXG4gICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdJbnZhbGlkIGxheW91dCBkYXRhJ1xuICAgICAgfSwgeyBzdGF0dXM6IDQwMCB9KVxuICAgIH1cblxuICAgIC8vIFN0YXJ0IHRyYW5zYWN0aW9uXG4gICAgYXdhaXQgY2xpZW50LnF1ZXJ5KCdCRUdJTicpXG4gICAgY29uc29sZS5sb2coJ/CflIQgUE9TVDogU3RhcnRlZCBkYXRhYmFzZSB0cmFuc2FjdGlvbicpXG5cbiAgICAvLyBHZXQgb3IgY3JlYXRlIGxheW91dCBJRFxuICAgIGNvbnN0IGxheW91dFJlc3VsdCA9IGF3YWl0IGNsaWVudC5xdWVyeShcbiAgICAgIGBTRUxFQ1QgaWQgRlJPTSB0cmFpbGVyX2xheW91dHMgV0hFUkUgdHJ1Y2tsb2FkX2lkID0gJDEgQU5EIGxheW91dF90eXBlID0gJDJgLFxuICAgICAgW3RydWNrbG9hZElkLCBsYXlvdXRUeXBlXVxuICAgIClcblxuICAgIGxldCBsYXlvdXRJZDogbnVtYmVyXG4gICAgaWYgKGxheW91dFJlc3VsdC5yb3dzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29uc29sZS5sb2coJ/Cfk50gUE9TVDogQ3JlYXRpbmcgbmV3IGxheW91dCBmb3IgdHJ1Y2tsb2FkOicsIHRydWNrbG9hZElkLCAndHlwZTonLCBsYXlvdXRUeXBlKVxuICAgICAgY29uc3QgbmV3TGF5b3V0UmVzdWx0ID0gYXdhaXQgY2xpZW50LnF1ZXJ5KFxuICAgICAgICBgSU5TRVJUIElOVE8gdHJhaWxlcl9sYXlvdXRzICh0cnVja2xvYWRfaWQsIGxheW91dF90eXBlKSBWQUxVRVMgKCQxLCAkMikgUkVUVVJOSU5HIGlkYCxcbiAgICAgICAgW3RydWNrbG9hZElkLCBsYXlvdXRUeXBlXVxuICAgICAgKVxuICAgICAgbGF5b3V0SWQgPSBuZXdMYXlvdXRSZXN1bHQucm93c1swXS5pZFxuICAgICAgY29uc29sZS5sb2coJ+KchSBQT1NUOiBDcmVhdGVkIG5ldyBsYXlvdXQgd2l0aCBJRDonLCBsYXlvdXRJZClcbiAgICB9IGVsc2Uge1xuICAgICAgbGF5b3V0SWQgPSBsYXlvdXRSZXN1bHQucm93c1swXS5pZFxuICAgICAgY29uc29sZS5sb2coJ/Cfk4sgUE9TVDogVXNpbmcgZXhpc3RpbmcgbGF5b3V0IHdpdGggSUQ6JywgbGF5b3V0SWQpXG4gICAgfVxuXG4gICAgLy8gRGVsZXRlIGV4aXN0aW5nIGxheW91dCBpdGVtc1xuICAgIGF3YWl0IGNsaWVudC5xdWVyeShcbiAgICAgIGBERUxFVEUgRlJPTSB0cmFpbGVyX2xheW91dF9pdGVtcyBXSEVSRSB0cmFpbGVyX2xheW91dF9pZCA9ICQxYCxcbiAgICAgIFtsYXlvdXRJZF1cbiAgICApXG4gICAgY29uc29sZS5sb2coJ/Cfl5HvuI8gUE9TVDogRGVsZXRlZCBleGlzdGluZyBsYXlvdXQgaXRlbXMnKVxuXG4gICAgLy8gR3JvdXAgaXRlbXMgYnkgc3RhY2sgZm9yIG9yZGVyZWQgaW5zZXJ0aW9uXG4gICAgY29uc3Qgc3RhY2tNYXAgPSBuZXcgTWFwPG51bWJlciwgTGF5b3V0SXRlbVtdPigpXG4gICAgY29uc3Qgbm9uU3RhY2tlZEl0ZW1zOiBMYXlvdXRJdGVtW10gPSBbXVxuXG4gICAgY29uc29sZS5sb2coJ/CflIQgUE9TVDogR3JvdXBpbmcgaXRlbXMgYnkgc3RhY2snKVxuICAgIGJvZHkubGF5b3V0LmZvckVhY2goKGl0ZW06IExheW91dEl0ZW0pID0+IHtcbiAgICAgIGlmIChpdGVtLnN0YWNrSWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjb25zdCBzdGFjayA9IHN0YWNrTWFwLmdldChpdGVtLnN0YWNrSWQpIHx8IFtdXG4gICAgICAgIHN0YWNrLnB1c2goaXRlbSlcbiAgICAgICAgc3RhY2tNYXAuc2V0KGl0ZW0uc3RhY2tJZCwgc3RhY2spXG4gICAgICAgIGNvbnNvbGUubG9nKGDwn5OaIFBPU1Q6IEFkZGVkIGl0ZW0gdG8gc3RhY2sgJHtpdGVtLnN0YWNrSWR9OmAsIHtcbiAgICAgICAgICBpZDogaXRlbS5za2lkSWQsXG4gICAgICAgICAgdHlwZTogaXRlbS50eXBlLFxuICAgICAgICAgIHBvczogaXRlbS5zdGFja1Bvc2l0aW9uXG4gICAgICAgIH0pXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBub25TdGFja2VkSXRlbXMucHVzaChpdGVtKVxuICAgICAgICBjb25zb2xlLmxvZygn8J+UgiBQT1NUOiBBZGRlZCBub24tc3RhY2tlZCBpdGVtOicsIHtcbiAgICAgICAgICBpZDogaXRlbS5za2lkSWQsXG4gICAgICAgICAgdHlwZTogaXRlbS50eXBlXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSlcblxuICAgIC8vIFByb2Nlc3MgYW5kIGluc2VydCBub24tc3RhY2tlZCBpdGVtc1xuICAgIGNvbnNvbGUubG9nKCfwn5OdIFBPU1Q6IEluc2VydGluZyBub24tc3RhY2tlZCBpdGVtcycpXG4gICAgZm9yIChjb25zdCBpdGVtIG9mIG5vblN0YWNrZWRJdGVtcykge1xuICAgICAgYXdhaXQgY2xpZW50LnF1ZXJ5KFxuICAgICAgICBgSU5TRVJUIElOVE8gdHJhaWxlcl9sYXlvdXRfaXRlbXMgKFxuICAgICAgICAgIHRyYWlsZXJfbGF5b3V0X2lkLFxuICAgICAgICAgIGl0ZW1fdHlwZSxcbiAgICAgICAgICBpdGVtX2lkLFxuICAgICAgICAgIHhfcG9zaXRpb24sXG4gICAgICAgICAgeV9wb3NpdGlvbixcbiAgICAgICAgICB3aWR0aCxcbiAgICAgICAgICBsZW5ndGgsXG4gICAgICAgICAgcm90YXRpb24sXG4gICAgICAgICAgY3VzdG9tZXJfaWQsXG4gICAgICAgICAgY3VzdG9tZXJfbmFtZSxcbiAgICAgICAgICBzdGFja19pZCxcbiAgICAgICAgICBzdGFja19wb3NpdGlvblxuICAgICAgICApIFZBTFVFUyAoJDEsICQyLCAkMywgJDQsICQ1LCAkNiwgJDcsICQ4LCAkOSwgJDEwLCAkMTEsICQxMilgLFxuICAgICAgICBbXG4gICAgICAgICAgbGF5b3V0SWQsXG4gICAgICAgICAgaXRlbS50eXBlLFxuICAgICAgICAgIGl0ZW0uc2tpZElkLFxuICAgICAgICAgIGl0ZW0ueCxcbiAgICAgICAgICBpdGVtLnksXG4gICAgICAgICAgaXRlbS53aWR0aCxcbiAgICAgICAgICBpdGVtLmxlbmd0aCxcbiAgICAgICAgICBpdGVtLnJvdGF0aW9uIHx8IDAsXG4gICAgICAgICAgaXRlbS5jdXN0b21lcklkLFxuICAgICAgICAgIGl0ZW0uY3VzdG9tZXJOYW1lLFxuICAgICAgICAgIG51bGwsXG4gICAgICAgICAgbnVsbFxuICAgICAgICBdXG4gICAgICApXG4gICAgICBjb25zb2xlLmxvZygn4pyFIFBPU1Q6IEluc2VydGVkIG5vbi1zdGFja2VkIGl0ZW06Jywge1xuICAgICAgICBpZDogaXRlbS5za2lkSWQsXG4gICAgICAgIHR5cGU6IGl0ZW0udHlwZVxuICAgICAgfSlcbiAgICB9XG5cbiAgICAvLyBQcm9jZXNzIGFuZCBpbnNlcnQgc3RhY2tlZCBpdGVtc1xuICAgIGNvbnNvbGUubG9nKCfwn5OdIFBPU1Q6IFByb2Nlc3Npbmcgc3RhY2tzJylcbiAgICBmb3IgKGNvbnN0IFtzdGFja0lkLCBpdGVtc10gb2YgQXJyYXkuZnJvbShzdGFja01hcCkpIHtcbiAgICAgIGNvbnNvbGUubG9nKGDwn5SEIFBPU1Q6IFByb2Nlc3Npbmcgc3RhY2sgJHtzdGFja0lkfSB3aXRoICR7aXRlbXMubGVuZ3RofSBpdGVtc2ApXG4gICAgICBcbiAgICAgIC8vIFNvcnQgaXRlbXMgYnkgc3RhY2sgcG9zaXRpb24gKGhpZ2hlc3QgbnVtYmVyIG9uIHRvcClcbiAgICAgIGl0ZW1zLnNvcnQoKGE6IExheW91dEl0ZW0sIGI6IExheW91dEl0ZW0pID0+IChiLnN0YWNrUG9zaXRpb24gfHwgMCkgLSAoYS5zdGFja1Bvc2l0aW9uIHx8IDApKVxuICAgICAgXG4gICAgICAvLyBVc2UgdGhlIGJvdHRvbSBpdGVtJ3MgcG9zaXRpb24gZm9yIHRoZSBlbnRpcmUgc3RhY2tcbiAgICAgIGNvbnN0IGJvdHRvbUl0ZW0gPSBpdGVtc1tpdGVtcy5sZW5ndGggLSAxXVxuICAgICAgY29uc3Qgc3RhY2tYID0gYm90dG9tSXRlbS54XG4gICAgICBjb25zdCBzdGFja1kgPSBib3R0b21JdGVtLnlcblxuICAgICAgLy8gSW5zZXJ0IGl0ZW1zIGluIG9yZGVyIChmcm9tIGJvdHRvbSB0byB0b3ApXG4gICAgICBmb3IgKGxldCBpID0gaXRlbXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgY29uc3QgaXRlbSA9IGl0ZW1zW2ldXG4gICAgICAgIGNvbnN0IHN0YWNrUG9zaXRpb24gPSBpdGVtcy5sZW5ndGggLSBpIC8vIFBvc2l0aW9uIDEgaXMgYm90dG9tXG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZyhg8J+TpiBQT1NUOiBJbnNlcnRpbmcgc3RhY2sgaXRlbTpgLCB7XG4gICAgICAgICAgaWQ6IGl0ZW0uc2tpZElkLFxuICAgICAgICAgIHR5cGU6IGl0ZW0udHlwZSxcbiAgICAgICAgICBzdGFja0lkLFxuICAgICAgICAgIHBvc2l0aW9uOiBzdGFja1Bvc2l0aW9uLFxuICAgICAgICAgIHg6IHN0YWNrWCxcbiAgICAgICAgICB5OiBzdGFja1lcbiAgICAgICAgfSlcbiAgICAgICAgXG4gICAgICAgIGF3YWl0IGNsaWVudC5xdWVyeShcbiAgICAgICAgICBgSU5TRVJUIElOVE8gdHJhaWxlcl9sYXlvdXRfaXRlbXMgKFxuICAgICAgICAgICAgdHJhaWxlcl9sYXlvdXRfaWQsXG4gICAgICAgICAgICBpdGVtX3R5cGUsXG4gICAgICAgICAgICBpdGVtX2lkLFxuICAgICAgICAgICAgeF9wb3NpdGlvbixcbiAgICAgICAgICAgIHlfcG9zaXRpb24sXG4gICAgICAgICAgICB3aWR0aCxcbiAgICAgICAgICAgIGxlbmd0aCxcbiAgICAgICAgICAgIHJvdGF0aW9uLFxuICAgICAgICAgICAgY3VzdG9tZXJfaWQsXG4gICAgICAgICAgICBjdXN0b21lcl9uYW1lLFxuICAgICAgICAgICAgc3RhY2tfaWQsXG4gICAgICAgICAgICBzdGFja19wb3NpdGlvblxuICAgICAgICAgICkgVkFMVUVTICgkMSwgJDIsICQzLCAkNCwgJDUsICQ2LCAkNywgJDgsICQ5LCAkMTAsICQxMSwgJDEyKWAsXG4gICAgICAgICAgW1xuICAgICAgICAgICAgbGF5b3V0SWQsXG4gICAgICAgICAgICBpdGVtLnR5cGUsXG4gICAgICAgICAgICBpdGVtLnNraWRJZCxcbiAgICAgICAgICAgIHN0YWNrWCxcbiAgICAgICAgICAgIHN0YWNrWSxcbiAgICAgICAgICAgIGl0ZW0ud2lkdGgsXG4gICAgICAgICAgICBpdGVtLmxlbmd0aCxcbiAgICAgICAgICAgIGl0ZW0ucm90YXRpb24gfHwgMCxcbiAgICAgICAgICAgIGl0ZW0uY3VzdG9tZXJJZCxcbiAgICAgICAgICAgIGl0ZW0uY3VzdG9tZXJOYW1lLFxuICAgICAgICAgICAgc3RhY2tJZCxcbiAgICAgICAgICAgIHN0YWNrUG9zaXRpb25cbiAgICAgICAgICBdXG4gICAgICAgIClcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coYOKchSBQT1NUOiBDb21wbGV0ZWQgc3RhY2sgJHtzdGFja0lkfSBpbnNlcnRpb25gKVxuICAgIH1cblxuICAgIC8vIENvbW1pdCB0cmFuc2FjdGlvblxuICAgIGF3YWl0IGNsaWVudC5xdWVyeSgnQ09NTUlUJylcbiAgICBjb25zb2xlLmxvZygn4pyFIFBPU1Q6IFRyYW5zYWN0aW9uIGNvbW1pdHRlZCBzdWNjZXNzZnVsbHknKVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogdHJ1ZSB9KVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBQT1NUOiBFcnJvcjonLCBlcnJvcilcbiAgICB0cnkge1xuICAgICAgYXdhaXQgY2xpZW50LnF1ZXJ5KCdST0xMQkFDSycpXG4gICAgICBjb25zb2xlLmxvZygn8J+UhCBQT1NUOiBUcmFuc2FjdGlvbiByb2xsZWQgYmFjaycpXG4gICAgfSBjYXRjaCAocm9sbGJhY2tFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIFBPU1Q6IEVycm9yIGR1cmluZyByb2xsYmFjazonLCByb2xsYmFja0Vycm9yKVxuICAgIH1cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdBbiBlcnJvciBvY2N1cnJlZCcgXG4gICAgfSwgeyBzdGF0dXM6IDUwMCB9KVxuICB9IGZpbmFsbHkge1xuICAgIGNsaWVudC5yZWxlYXNlKClcbiAgfVxufSAiXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiZGJRdWVyeSIsImdldFBvb2wiLCJnZXRDbGllbnQiLCJnZXRTZXJ2ZXJTZXNzaW9uIiwiYXV0aE9wdGlvbnMiLCJpc1ZhbGlkRGltZW5zaW9uIiwidmFsdWUiLCJpc1ZhbGlkUG9zaXRpb24iLCJpc1ZhbGlkTGF5b3V0SXRlbSIsIml0ZW0iLCJjb25zb2xlIiwiZXJyb3IiLCJpbmNsdWRlcyIsInR5cGUiLCJ4IiwieSIsIndpZHRoIiwibGVuZ3RoIiwic2tpZElkIiwic3RhY2tJZCIsInVuZGVmaW5lZCIsInN0YWNrUG9zaXRpb24iLCJyb3RhdGlvbiIsImN1c3RvbWVySWQiLCJjdXN0b21lck5hbWUiLCJ2YWxpZGF0ZUxheW91dCIsImxheW91dCIsIkFycmF5IiwiaXNBcnJheSIsIkVycm9yIiwiSlNPTiIsInN0cmluZ2lmeSIsInN0YWNrSXRlbXMiLCJmaWx0ZXIiLCJzdGFja0dyb3VwcyIsIk1hcCIsImZvckVhY2giLCJoYXMiLCJzZXQiLCJnZXQiLCJwdXNoIiwiaXRlbXMiLCJmcm9tIiwiZW50cmllcyIsImZpcnN0SXRlbSIsImludmFsaWRQb3NpdGlvbiIsInNvbWUiLCJleGlzdGluZ0l0ZW1zIiwibmV3SXRlbXMiLCJoaWdoZXN0UG9zaXRpb24iLCJNYXRoIiwibWF4IiwibWFwIiwiaW5kZXgiLCJzb3J0ZWRJdGVtcyIsInNvcnQiLCJhIiwiYiIsImFQb3MiLCJiUG9zIiwiR0VUIiwicmVxdWVzdCIsInBhcmFtcyIsInNlc3Npb24iLCJ1c2VyIiwianNvbiIsInN1Y2Nlc3MiLCJzdGF0dXMiLCJ0cnVja2xvYWRJZCIsInBhcnNlSW50IiwiaWQiLCJpc05hTiIsInNlYXJjaFBhcmFtcyIsIlVSTCIsInVybCIsImxheW91dFR5cGUiLCJsb2ciLCJyZXN1bHQiLCJyb3dzIiwic3RhY2tNYXAiLCJub25TdGFja2VkSXRlbXMiLCJyb3ciLCJpdGVtX2lkIiwiaXRlbV90eXBlIiwieF9wb3NpdGlvbiIsInlfcG9zaXRpb24iLCJjdXN0b21lcl9pZCIsImN1c3RvbWVyX25hbWUiLCJzdGFja19pZCIsInN0YWNrX3Bvc2l0aW9uIiwicG9zIiwiYm90dG9tSXRlbSIsImkiLCJ2YWx1ZXMiLCJmbGF0IiwibWVzc2FnZSIsIlBPU1QiLCJjbGllbnQiLCJib2R5IiwicXVlcnkiLCJsYXlvdXRSZXN1bHQiLCJsYXlvdXRJZCIsIm5ld0xheW91dFJlc3VsdCIsInN0YWNrIiwic3RhY2tYIiwic3RhY2tZIiwicG9zaXRpb24iLCJyb2xsYmFja0Vycm9yIiwicmVsZWFzZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/truckloads/[id]/layout/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth.ts":
/*!*********************!*\
  !*** ./lib/auth.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authOptions: () => (/* binding */ authOptions),\n/* harmony export */   getSession: () => (/* binding */ getSession)\n/* harmony export */ });\n/* harmony import */ var next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth/providers/credentials */ \"(rsc)/./node_modules/next-auth/providers/credentials.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./lib/db.ts\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\nconst authOptions = {\n    providers: [\n        (0,next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n            name: \"Credentials\",\n            credentials: {\n                username: {\n                    label: \"Username\",\n                    type: \"text\"\n                },\n                password: {\n                    label: \"Password\",\n                    type: \"password\"\n                }\n            },\n            async authorize (credentials) {\n                if (!credentials?.username || !credentials?.password) {\n                    return null;\n                }\n                try {\n                    // Find user by username\n                    const result = await (0,_lib_db__WEBPACK_IMPORTED_MODULE_1__.query)(\"SELECT id, username, password_hash, full_name, role FROM users WHERE username = $1 AND is_active = true\", [\n                        credentials.username\n                    ]);\n                    const user = result.rows[0];\n                    if (!user) {\n                        return null;\n                    }\n                    // Verify password\n                    const isValid = await bcryptjs__WEBPACK_IMPORTED_MODULE_2___default().compare(credentials.password, user.password_hash);\n                    if (!isValid) {\n                        return null;\n                    }\n                    // Return user data (excluding password)\n                    return {\n                        id: user.id,\n                        username: user.username,\n                        name: user.full_name,\n                        role: user.role\n                    };\n                } catch (error) {\n                    console.error(\"Error in auth:\", error);\n                    return null;\n                }\n            }\n        })\n    ],\n    session: {\n        strategy: \"jwt\",\n        maxAge: 24 * 60 * 60\n    },\n    callbacks: {\n        async jwt ({ token, user }) {\n            if (user) {\n                token.id = user.id;\n                token.role = user.role;\n            }\n            return token;\n        },\n        async session ({ session, token }) {\n            if (token) {\n                session.user.id = token.id;\n                session.user.role = token.role;\n            }\n            return session;\n        }\n    },\n    pages: {\n        signIn: \"/auth/signin\",\n        error: \"/auth/error\"\n    }\n};\n// Basic auth helper for development\nasync function getSession() {\n    // TODO: Implement proper authentication\n    return {\n        user: {\n            id: 1,\n            name: \"Development User\",\n            email: \"dev@example.com\"\n        }\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvYXV0aC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFDa0U7QUFDakM7QUFDSDtBQUV2QixNQUFNRyxjQUErQjtJQUMxQ0MsV0FBVztRQUNUSiwyRUFBbUJBLENBQUM7WUFDbEJLLE1BQU07WUFDTkMsYUFBYTtnQkFDWEMsVUFBVTtvQkFBRUMsT0FBTztvQkFBWUMsTUFBTTtnQkFBTztnQkFDNUNDLFVBQVU7b0JBQUVGLE9BQU87b0JBQVlDLE1BQU07Z0JBQVc7WUFDbEQ7WUFDQSxNQUFNRSxXQUFVTCxXQUFXO2dCQUN6QixJQUFJLENBQUNBLGFBQWFDLFlBQVksQ0FBQ0QsYUFBYUksVUFBVTtvQkFDcEQsT0FBTztnQkFDVDtnQkFFQSxJQUFJO29CQUNGLHdCQUF3QjtvQkFDeEIsTUFBTUUsU0FBUyxNQUFNWCw4Q0FBS0EsQ0FDeEIsMkdBQ0E7d0JBQUNLLFlBQVlDLFFBQVE7cUJBQUM7b0JBR3hCLE1BQU1NLE9BQU9ELE9BQU9FLElBQUksQ0FBQyxFQUFFO29CQUUzQixJQUFJLENBQUNELE1BQU07d0JBQ1QsT0FBTztvQkFDVDtvQkFFQSxrQkFBa0I7b0JBQ2xCLE1BQU1FLFVBQVUsTUFBTWIsdURBQWMsQ0FBQ0ksWUFBWUksUUFBUSxFQUFFRyxLQUFLSSxhQUFhO29CQUU3RSxJQUFJLENBQUNGLFNBQVM7d0JBQ1osT0FBTztvQkFDVDtvQkFFQSx3Q0FBd0M7b0JBQ3hDLE9BQU87d0JBQ0xHLElBQUlMLEtBQUtLLEVBQUU7d0JBQ1hYLFVBQVVNLEtBQUtOLFFBQVE7d0JBQ3ZCRixNQUFNUSxLQUFLTSxTQUFTO3dCQUNwQkMsTUFBTVAsS0FBS08sSUFBSTtvQkFDakI7Z0JBQ0YsRUFBRSxPQUFPQyxPQUFPO29CQUNkQyxRQUFRRCxLQUFLLENBQUMsa0JBQWtCQTtvQkFDaEMsT0FBTztnQkFDVDtZQUNGO1FBQ0Y7S0FDRDtJQUNERSxTQUFTO1FBQ1BDLFVBQVU7UUFDVkMsUUFBUSxLQUFLLEtBQUs7SUFDcEI7SUFDQUMsV0FBVztRQUNULE1BQU1DLEtBQUksRUFBRUMsS0FBSyxFQUFFZixJQUFJLEVBQUU7WUFDdkIsSUFBSUEsTUFBTTtnQkFDUmUsTUFBTVYsRUFBRSxHQUFHTCxLQUFLSyxFQUFFO2dCQUNsQlUsTUFBTVIsSUFBSSxHQUFHUCxLQUFLTyxJQUFJO1lBQ3hCO1lBQ0EsT0FBT1E7UUFDVDtRQUNBLE1BQU1MLFNBQVEsRUFBRUEsT0FBTyxFQUFFSyxLQUFLLEVBQUU7WUFDOUIsSUFBSUEsT0FBTztnQkFDVEwsUUFBUVYsSUFBSSxDQUFDSyxFQUFFLEdBQUdVLE1BQU1WLEVBQUU7Z0JBQzFCSyxRQUFRVixJQUFJLENBQUNPLElBQUksR0FBR1EsTUFBTVIsSUFBSTtZQUNoQztZQUNBLE9BQU9HO1FBQ1Q7SUFDRjtJQUNBTSxPQUFPO1FBQ0xDLFFBQVE7UUFDUlQsT0FBTztJQUNUO0FBQ0YsRUFBRTtBQUVGLG9DQUFvQztBQUM3QixlQUFlVTtJQUNwQix3Q0FBd0M7SUFDeEMsT0FBTztRQUNMbEIsTUFBTTtZQUNKSyxJQUFJO1lBQ0piLE1BQU07WUFDTjJCLE9BQU87UUFDVDtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aW1iZXJsaW5lLWxvZ2lzdGljcy1kYXNoYm9hcmQvLi9saWIvYXV0aC50cz9iZjdlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRBdXRoT3B0aW9ucyB9IGZyb20gJ25leHQtYXV0aCc7XG5pbXBvcnQgQ3JlZGVudGlhbHNQcm92aWRlciBmcm9tICduZXh0LWF1dGgvcHJvdmlkZXJzL2NyZWRlbnRpYWxzJztcbmltcG9ydCB7IHF1ZXJ5IH0gZnJvbSAnQC9saWIvZGInO1xuaW1wb3J0IGJjcnlwdCBmcm9tICdiY3J5cHRqcyc7XG5cbmV4cG9ydCBjb25zdCBhdXRoT3B0aW9uczogTmV4dEF1dGhPcHRpb25zID0ge1xuICBwcm92aWRlcnM6IFtcbiAgICBDcmVkZW50aWFsc1Byb3ZpZGVyKHtcbiAgICAgIG5hbWU6ICdDcmVkZW50aWFscycsXG4gICAgICBjcmVkZW50aWFsczoge1xuICAgICAgICB1c2VybmFtZTogeyBsYWJlbDogXCJVc2VybmFtZVwiLCB0eXBlOiBcInRleHRcIiB9LFxuICAgICAgICBwYXNzd29yZDogeyBsYWJlbDogXCJQYXNzd29yZFwiLCB0eXBlOiBcInBhc3N3b3JkXCIgfVxuICAgICAgfSxcbiAgICAgIGFzeW5jIGF1dGhvcml6ZShjcmVkZW50aWFscykge1xuICAgICAgICBpZiAoIWNyZWRlbnRpYWxzPy51c2VybmFtZSB8fCAhY3JlZGVudGlhbHM/LnBhc3N3b3JkKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgIC8vIEZpbmQgdXNlciBieSB1c2VybmFtZVxuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHF1ZXJ5KFxuICAgICAgICAgICAgJ1NFTEVDVCBpZCwgdXNlcm5hbWUsIHBhc3N3b3JkX2hhc2gsIGZ1bGxfbmFtZSwgcm9sZSBGUk9NIHVzZXJzIFdIRVJFIHVzZXJuYW1lID0gJDEgQU5EIGlzX2FjdGl2ZSA9IHRydWUnLFxuICAgICAgICAgICAgW2NyZWRlbnRpYWxzLnVzZXJuYW1lXVxuICAgICAgICAgICk7XG5cbiAgICAgICAgICBjb25zdCB1c2VyID0gcmVzdWx0LnJvd3NbMF07XG5cbiAgICAgICAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIFZlcmlmeSBwYXNzd29yZFxuICAgICAgICAgIGNvbnN0IGlzVmFsaWQgPSBhd2FpdCBiY3J5cHQuY29tcGFyZShjcmVkZW50aWFscy5wYXNzd29yZCwgdXNlci5wYXNzd29yZF9oYXNoKTtcblxuICAgICAgICAgIGlmICghaXNWYWxpZCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gUmV0dXJuIHVzZXIgZGF0YSAoZXhjbHVkaW5nIHBhc3N3b3JkKVxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogdXNlci5pZCxcbiAgICAgICAgICAgIHVzZXJuYW1lOiB1c2VyLnVzZXJuYW1lLFxuICAgICAgICAgICAgbmFtZTogdXNlci5mdWxsX25hbWUsXG4gICAgICAgICAgICByb2xlOiB1c2VyLnJvbGVcbiAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGF1dGg6JywgZXJyb3IpO1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcbiAgXSxcbiAgc2Vzc2lvbjoge1xuICAgIHN0cmF0ZWd5OiAnand0JyxcbiAgICBtYXhBZ2U6IDI0ICogNjAgKiA2MCwgLy8gMjQgaG91cnNcbiAgfSxcbiAgY2FsbGJhY2tzOiB7XG4gICAgYXN5bmMgand0KHsgdG9rZW4sIHVzZXIgfSkge1xuICAgICAgaWYgKHVzZXIpIHtcbiAgICAgICAgdG9rZW4uaWQgPSB1c2VyLmlkO1xuICAgICAgICB0b2tlbi5yb2xlID0gdXNlci5yb2xlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRva2VuO1xuICAgIH0sXG4gICAgYXN5bmMgc2Vzc2lvbih7IHNlc3Npb24sIHRva2VuIH0pIHtcbiAgICAgIGlmICh0b2tlbikge1xuICAgICAgICBzZXNzaW9uLnVzZXIuaWQgPSB0b2tlbi5pZDtcbiAgICAgICAgc2Vzc2lvbi51c2VyLnJvbGUgPSB0b2tlbi5yb2xlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHNlc3Npb247XG4gICAgfVxuICB9LFxuICBwYWdlczoge1xuICAgIHNpZ25JbjogJy9hdXRoL3NpZ25pbicsXG4gICAgZXJyb3I6ICcvYXV0aC9lcnJvcicsXG4gIH1cbn07XG5cbi8vIEJhc2ljIGF1dGggaGVscGVyIGZvciBkZXZlbG9wbWVudFxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFNlc3Npb24oKSB7XG4gIC8vIFRPRE86IEltcGxlbWVudCBwcm9wZXIgYXV0aGVudGljYXRpb25cbiAgcmV0dXJuIHtcbiAgICB1c2VyOiB7XG4gICAgICBpZDogMSxcbiAgICAgIG5hbWU6ICdEZXZlbG9wbWVudCBVc2VyJyxcbiAgICAgIGVtYWlsOiAnZGV2QGV4YW1wbGUuY29tJ1xuICAgIH1cbiAgfTtcbn0gIl0sIm5hbWVzIjpbIkNyZWRlbnRpYWxzUHJvdmlkZXIiLCJxdWVyeSIsImJjcnlwdCIsImF1dGhPcHRpb25zIiwicHJvdmlkZXJzIiwibmFtZSIsImNyZWRlbnRpYWxzIiwidXNlcm5hbWUiLCJsYWJlbCIsInR5cGUiLCJwYXNzd29yZCIsImF1dGhvcml6ZSIsInJlc3VsdCIsInVzZXIiLCJyb3dzIiwiaXNWYWxpZCIsImNvbXBhcmUiLCJwYXNzd29yZF9oYXNoIiwiaWQiLCJmdWxsX25hbWUiLCJyb2xlIiwiZXJyb3IiLCJjb25zb2xlIiwic2Vzc2lvbiIsInN0cmF0ZWd5IiwibWF4QWdlIiwiY2FsbGJhY2tzIiwiand0IiwidG9rZW4iLCJwYWdlcyIsInNpZ25JbiIsImdldFNlc3Npb24iLCJlbWFpbCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db.ts":
/*!*******************!*\
  !*** ./lib/db.ts ***!
  \*******************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkDatabaseConnection: () => (/* binding */ checkDatabaseConnection),\n/* harmony export */   closePool: () => (/* binding */ closePool),\n/* harmony export */   dbQuery: () => (/* binding */ dbQuery),\n/* harmony export */   getClient: () => (/* reexport safe */ _db_index__WEBPACK_IMPORTED_MODULE_1__.getClient),\n/* harmony export */   getPool: () => (/* binding */ getPool),\n/* harmony export */   query: () => (/* reexport safe */ _db_index__WEBPACK_IMPORTED_MODULE_1__.query),\n/* harmony export */   sql: () => (/* reexport safe */ _vercel_postgres__WEBPACK_IMPORTED_MODULE_0__.sql),\n/* harmony export */   withTransaction: () => (/* reexport safe */ _db_index__WEBPACK_IMPORTED_MODULE_1__.withTransaction)\n/* harmony export */ });\n/* harmony import */ var _vercel_postgres__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @vercel/postgres */ \"(rsc)/./node_modules/@vercel/postgres/dist/index-node.js\");\n/* harmony import */ var _db_index__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./db/index */ \"(rsc)/./lib/db/index.ts\");\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! pg */ \"pg\");\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(pg__WEBPACK_IMPORTED_MODULE_2__);\n\n\n\n\nlet pool = null;\n// Parse connection string to explicit config\nfunction parseConnectionString(connectionString) {\n    try {\n        const url = new URL(connectionString);\n        return {\n            user: url.username,\n            password: url.password,\n            host: url.hostname,\n            port: Number(url.port) || 5432,\n            database: url.pathname.slice(1),\n            ssl: true\n        };\n    } catch (error) {\n        console.error(\"Error parsing connection string:\", error);\n        throw error;\n    }\n}\n// Database configuration\nconst config = {\n    preview: parseConnectionString(\"postgresql://neondb_owner:npg_D5hj1egPlAok@ep-proud-glitter-a85pbrz6-pooler.eastus2.azure.neon.tech/neondb?sslmode=require\"),\n    main: parseConnectionString(\"postgresql://neondb_owner:npg_D5hj1egPlAok@ep-calm-frog-a8qxyo8o-pooler.eastus2.azure.neon.tech/neondb?sslmode=require\")\n};\n// Determine which database branch to use based on environment\nconst isProduction = \"development\" === \"production\";\nconst branch = isProduction ? \"main\" : \"preview\";\nfunction getPool() {\n    if (!pool) {\n        const branchConfig = config[branch];\n        pool = new pg__WEBPACK_IMPORTED_MODULE_2__.Pool({\n            ...branchConfig,\n            ssl: {\n                rejectUnauthorized: true\n            }\n        });\n        // Handle pool errors\n        pool.on(\"error\", (err)=>{\n            console.error(\"Unexpected error on idle client\", err);\n            // Reset pool on error\n            pool = null;\n        });\n        // Add connection logging\n        pool.on(\"connect\", ()=>{\n            console.log(\"New database connection established\");\n        });\n        pool.on(\"acquire\", ()=>{\n            console.log(\"Client acquired from pool\");\n        });\n        pool.on(\"remove\", ()=>{\n            console.log(\"Client removed from pool\");\n        });\n    }\n    return pool;\n}\nasync function dbQuery(text, params) {\n    const pool = getPool();\n    const client = await pool.connect();\n    try {\n        return await client.query(text, params);\n    } finally{\n        client.release();\n    }\n}\n// Clean up function for tests\nasync function closePool() {\n    if (pool) {\n        await pool.end();\n        pool = null;\n    }\n}\n// Helper function to check database connection\nasync function checkDatabaseConnection() {\n    try {\n        await _vercel_postgres__WEBPACK_IMPORTED_MODULE_0__.sql`SELECT 1`;\n        return true;\n    } catch (error) {\n        console.error(\"Database connection error:\", error);\n        return false;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNDO0FBQ3dCO0FBQ3JDO0FBRXdCO0FBRWpELElBQUlLLE9BQW9CO0FBRXhCLDZDQUE2QztBQUM3QyxTQUFTQyxzQkFBc0JDLGdCQUF3QjtJQUNyRCxJQUFJO1FBQ0YsTUFBTUMsTUFBTSxJQUFJQyxJQUFJRjtRQUNwQixPQUFPO1lBQ0xHLE1BQU1GLElBQUlHLFFBQVE7WUFDbEJDLFVBQVVKLElBQUlJLFFBQVE7WUFDdEJDLE1BQU1MLElBQUlNLFFBQVE7WUFDbEJDLE1BQU1DLE9BQU9SLElBQUlPLElBQUksS0FBSztZQUMxQkUsVUFBVVQsSUFBSVUsUUFBUSxDQUFDQyxLQUFLLENBQUM7WUFDN0JDLEtBQUs7UUFDUDtJQUNGLEVBQUUsT0FBT0MsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsb0NBQW9DQTtRQUNsRCxNQUFNQTtJQUNSO0FBQ0Y7QUFFQSx5QkFBeUI7QUFDekIsTUFBTUUsU0FBUztJQUNiQyxTQUFTbEIsc0JBQXNCO0lBQy9CbUIsTUFBTW5CLHNCQUFzQjtBQUM5QjtBQUVBLDhEQUE4RDtBQUM5RCxNQUFNb0IsZUFBZUMsa0JBQXlCO0FBQzlDLE1BQU1DLFNBQVNGLGVBQWUsU0FBUztBQUVoQyxTQUFTRztJQUNkLElBQUksQ0FBQ3hCLE1BQU07UUFDVCxNQUFNeUIsZUFBZVAsTUFBTSxDQUFDSyxPQUFPO1FBQ25DdkIsT0FBTyxJQUFJRCxvQ0FBSUEsQ0FBQztZQUNkLEdBQUcwQixZQUFZO1lBQ2ZWLEtBQUs7Z0JBQ0hXLG9CQUFvQjtZQUN0QjtRQUNGO1FBRUEscUJBQXFCO1FBQ3JCMUIsS0FBSzJCLEVBQUUsQ0FBQyxTQUFTLENBQUNDO1lBQ2hCWCxRQUFRRCxLQUFLLENBQUMsbUNBQW1DWTtZQUNqRCxzQkFBc0I7WUFDdEI1QixPQUFPO1FBQ1Q7UUFFQSx5QkFBeUI7UUFDekJBLEtBQUsyQixFQUFFLENBQUMsV0FBVztZQUNqQlYsUUFBUVksR0FBRyxDQUFDO1FBQ2Q7UUFFQTdCLEtBQUsyQixFQUFFLENBQUMsV0FBVztZQUNqQlYsUUFBUVksR0FBRyxDQUFDO1FBQ2Q7UUFFQTdCLEtBQUsyQixFQUFFLENBQUMsVUFBVTtZQUNoQlYsUUFBUVksR0FBRyxDQUFDO1FBQ2Q7SUFDRjtJQUNBLE9BQU83QjtBQUNUO0FBRU8sZUFBZThCLFFBQVFDLElBQVksRUFBRUMsTUFBYztJQUN4RCxNQUFNaEMsT0FBT3dCO0lBQ2IsTUFBTVMsU0FBUyxNQUFNakMsS0FBS2tDLE9BQU87SUFDakMsSUFBSTtRQUNGLE9BQU8sTUFBTUQsT0FBT3JDLEtBQUssQ0FBQ21DLE1BQU1DO0lBQ2xDLFNBQVU7UUFDUkMsT0FBT0UsT0FBTztJQUNoQjtBQUNGO0FBRUEsOEJBQThCO0FBQ3ZCLGVBQWVDO0lBQ3BCLElBQUlwQyxNQUFNO1FBQ1IsTUFBTUEsS0FBS3FDLEdBQUc7UUFDZHJDLE9BQU87SUFDVDtBQUNGO0FBRUEsK0NBQStDO0FBQ3hDLGVBQWVzQztJQUNwQixJQUFJO1FBQ0YsTUFBTTNDLGlEQUFHLENBQUMsUUFBUSxDQUFDO1FBQ25CLE9BQU87SUFDVCxFQUFFLE9BQU9xQixPQUFPO1FBQ2RDLFFBQVFELEtBQUssQ0FBQyw4QkFBOEJBO1FBQzVDLE9BQU87SUFDVDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdGltYmVybGluZS1sb2dpc3RpY3MtZGFzaGJvYXJkLy4vbGliL2RiLnRzPzFkZjAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3FsIH0gZnJvbSAnQHZlcmNlbC9wb3N0Z3JlcydcbmltcG9ydCB7IHF1ZXJ5LCBnZXRDbGllbnQsIHdpdGhUcmFuc2FjdGlvbiB9IGZyb20gJy4vZGIvaW5kZXgnXG5pbXBvcnQgeyBQb29sIH0gZnJvbSAncGcnXG5cbmV4cG9ydCB7IHNxbCwgcXVlcnksIGdldENsaWVudCwgd2l0aFRyYW5zYWN0aW9uIH1cblxubGV0IHBvb2w6IFBvb2wgfCBudWxsID0gbnVsbFxuXG4vLyBQYXJzZSBjb25uZWN0aW9uIHN0cmluZyB0byBleHBsaWNpdCBjb25maWdcbmZ1bmN0aW9uIHBhcnNlQ29ubmVjdGlvblN0cmluZyhjb25uZWN0aW9uU3RyaW5nOiBzdHJpbmcpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB1cmwgPSBuZXcgVVJMKGNvbm5lY3Rpb25TdHJpbmcpXG4gICAgcmV0dXJuIHtcbiAgICAgIHVzZXI6IHVybC51c2VybmFtZSxcbiAgICAgIHBhc3N3b3JkOiB1cmwucGFzc3dvcmQsXG4gICAgICBob3N0OiB1cmwuaG9zdG5hbWUsXG4gICAgICBwb3J0OiBOdW1iZXIodXJsLnBvcnQpIHx8IDU0MzIsXG4gICAgICBkYXRhYmFzZTogdXJsLnBhdGhuYW1lLnNsaWNlKDEpLFxuICAgICAgc3NsOiB0cnVlXG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHBhcnNpbmcgY29ubmVjdGlvbiBzdHJpbmc6JywgZXJyb3IpXG4gICAgdGhyb3cgZXJyb3JcbiAgfVxufVxuXG4vLyBEYXRhYmFzZSBjb25maWd1cmF0aW9uXG5jb25zdCBjb25maWcgPSB7XG4gIHByZXZpZXc6IHBhcnNlQ29ubmVjdGlvblN0cmluZyhcInBvc3RncmVzcWw6Ly9uZW9uZGJfb3duZXI6bnBnX0Q1aGoxZWdQbEFva0BlcC1wcm91ZC1nbGl0dGVyLWE4NXBicno2LXBvb2xlci5lYXN0dXMyLmF6dXJlLm5lb24udGVjaC9uZW9uZGI/c3NsbW9kZT1yZXF1aXJlXCIpLFxuICBtYWluOiBwYXJzZUNvbm5lY3Rpb25TdHJpbmcoXCJwb3N0Z3Jlc3FsOi8vbmVvbmRiX293bmVyOm5wZ19ENWhqMWVnUGxBb2tAZXAtY2FsbS1mcm9nLWE4cXh5bzhvLXBvb2xlci5lYXN0dXMyLmF6dXJlLm5lb24udGVjaC9uZW9uZGI/c3NsbW9kZT1yZXF1aXJlXCIpXG59XG5cbi8vIERldGVybWluZSB3aGljaCBkYXRhYmFzZSBicmFuY2ggdG8gdXNlIGJhc2VkIG9uIGVudmlyb25tZW50XG5jb25zdCBpc1Byb2R1Y3Rpb24gPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nXG5jb25zdCBicmFuY2ggPSBpc1Byb2R1Y3Rpb24gPyAnbWFpbicgOiAncHJldmlldydcblxuZXhwb3J0IGZ1bmN0aW9uIGdldFBvb2woKSB7XG4gIGlmICghcG9vbCkge1xuICAgIGNvbnN0IGJyYW5jaENvbmZpZyA9IGNvbmZpZ1ticmFuY2hdXG4gICAgcG9vbCA9IG5ldyBQb29sKHtcbiAgICAgIC4uLmJyYW5jaENvbmZpZyxcbiAgICAgIHNzbDoge1xuICAgICAgICByZWplY3RVbmF1dGhvcml6ZWQ6IHRydWVcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgLy8gSGFuZGxlIHBvb2wgZXJyb3JzXG4gICAgcG9vbC5vbignZXJyb3InLCAoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKCdVbmV4cGVjdGVkIGVycm9yIG9uIGlkbGUgY2xpZW50JywgZXJyKVxuICAgICAgLy8gUmVzZXQgcG9vbCBvbiBlcnJvclxuICAgICAgcG9vbCA9IG51bGxcbiAgICB9KVxuXG4gICAgLy8gQWRkIGNvbm5lY3Rpb24gbG9nZ2luZ1xuICAgIHBvb2wub24oJ2Nvbm5lY3QnLCAoKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygnTmV3IGRhdGFiYXNlIGNvbm5lY3Rpb24gZXN0YWJsaXNoZWQnKVxuICAgIH0pXG5cbiAgICBwb29sLm9uKCdhY3F1aXJlJywgKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coJ0NsaWVudCBhY3F1aXJlZCBmcm9tIHBvb2wnKVxuICAgIH0pXG5cbiAgICBwb29sLm9uKCdyZW1vdmUnLCAoKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygnQ2xpZW50IHJlbW92ZWQgZnJvbSBwb29sJylcbiAgICB9KVxuICB9XG4gIHJldHVybiBwb29sXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkYlF1ZXJ5KHRleHQ6IHN0cmluZywgcGFyYW1zPzogYW55W10pIHtcbiAgY29uc3QgcG9vbCA9IGdldFBvb2woKVxuICBjb25zdCBjbGllbnQgPSBhd2FpdCBwb29sLmNvbm5lY3QoKVxuICB0cnkge1xuICAgIHJldHVybiBhd2FpdCBjbGllbnQucXVlcnkodGV4dCwgcGFyYW1zKVxuICB9IGZpbmFsbHkge1xuICAgIGNsaWVudC5yZWxlYXNlKClcbiAgfVxufVxuXG4vLyBDbGVhbiB1cCBmdW5jdGlvbiBmb3IgdGVzdHNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjbG9zZVBvb2woKSB7XG4gIGlmIChwb29sKSB7XG4gICAgYXdhaXQgcG9vbC5lbmQoKVxuICAgIHBvb2wgPSBudWxsXG4gIH1cbn1cblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIGNoZWNrIGRhdGFiYXNlIGNvbm5lY3Rpb25cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjaGVja0RhdGFiYXNlQ29ubmVjdGlvbigpIHtcbiAgdHJ5IHtcbiAgICBhd2FpdCBzcWxgU0VMRUNUIDFgXG4gICAgcmV0dXJuIHRydWVcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdEYXRhYmFzZSBjb25uZWN0aW9uIGVycm9yOicsIGVycm9yKVxuICAgIHJldHVybiBmYWxzZVxuICB9XG59ICJdLCJuYW1lcyI6WyJzcWwiLCJxdWVyeSIsImdldENsaWVudCIsIndpdGhUcmFuc2FjdGlvbiIsIlBvb2wiLCJwb29sIiwicGFyc2VDb25uZWN0aW9uU3RyaW5nIiwiY29ubmVjdGlvblN0cmluZyIsInVybCIsIlVSTCIsInVzZXIiLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwiaG9zdCIsImhvc3RuYW1lIiwicG9ydCIsIk51bWJlciIsImRhdGFiYXNlIiwicGF0aG5hbWUiLCJzbGljZSIsInNzbCIsImVycm9yIiwiY29uc29sZSIsImNvbmZpZyIsInByZXZpZXciLCJtYWluIiwiaXNQcm9kdWN0aW9uIiwicHJvY2VzcyIsImJyYW5jaCIsImdldFBvb2wiLCJicmFuY2hDb25maWciLCJyZWplY3RVbmF1dGhvcml6ZWQiLCJvbiIsImVyciIsImxvZyIsImRiUXVlcnkiLCJ0ZXh0IiwicGFyYW1zIiwiY2xpZW50IiwiY29ubmVjdCIsInJlbGVhc2UiLCJjbG9zZVBvb2wiLCJlbmQiLCJjaGVja0RhdGFiYXNlQ29ubmVjdGlvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/db.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db/index.ts":
/*!*************************!*\
  !*** ./lib/db/index.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getClient: () => (/* binding */ getClient),\n/* harmony export */   query: () => (/* binding */ query),\n/* harmony export */   withTransaction: () => (/* binding */ withTransaction)\n/* harmony export */ });\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pg */ \"pg\");\n/* harmony import */ var pg__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(pg__WEBPACK_IMPORTED_MODULE_0__);\n\n// Parse connection string to explicit config\nfunction parseConnectionString(connectionString) {\n    try {\n        const url = new URL(connectionString);\n        return {\n            user: url.username,\n            password: url.password,\n            host: url.hostname,\n            port: Number(url.port) || 5432,\n            database: url.pathname.slice(1),\n            ssl: true\n        };\n    } catch (error) {\n        console.error(\"Error parsing connection string:\", error);\n        throw error;\n    }\n}\n// Database configuration\nconst config = {\n    preview: parseConnectionString(\"postgresql://neondb_owner:npg_D5hj1egPlAok@ep-proud-glitter-a85pbrz6-pooler.eastus2.azure.neon.tech/neondb?sslmode=require\"),\n    main: parseConnectionString(\"postgresql://neondb_owner:npg_D5hj1egPlAok@ep-calm-frog-a8qxyo8o-pooler.eastus2.azure.neon.tech/neondb?sslmode=require\")\n};\n// Determine which database branch to use based on environment\nconst isProduction = \"development\" === \"production\";\nconst branch = isProduction ? \"main\" : \"preview\";\nconsole.log(`Using database branch: ${branch}`);\nconsole.log(\"Database config:\", {\n    host: config[branch].host,\n    port: config[branch].port,\n    database: config[branch].database,\n    user: config[branch].user,\n    // password is masked for security\n    ssl: config[branch].ssl\n});\n// Connection pool settings\nconst CONNECTION_TIMEOUT_MS = 10000;\nconst IDLE_TIMEOUT_MS = 30000;\nconst MAX_POOL_SIZE = 20;\nconst CONNECTION_RETRY_ATTEMPTS = 3;\nconst CONNECTION_RETRY_DELAY_MS = 1000;\n// Create a connection pool with enhanced settings\nlet pool = null;\n// Migration SQL\nconst MIGRATIONS = [\n    `\n  -- Fix stack columns in trailer_layout_items\n  ALTER TABLE trailer_layout_items\n  DROP CONSTRAINT IF EXISTS fk_trailer_layout_items_stack;\n\n  ALTER TABLE trailer_layout_items\n  DROP CONSTRAINT IF EXISTS check_stack_position;\n\n  ALTER TABLE trailer_layout_items\n  DROP CONSTRAINT IF EXISTS check_stack_id_vinyl;\n\n  -- Ensure the columns exist with correct types\n  ALTER TABLE trailer_layout_items\n  DROP COLUMN IF EXISTS stack_id;\n\n  ALTER TABLE trailer_layout_items\n  DROP COLUMN IF EXISTS stack_position;\n\n  ALTER TABLE trailer_layout_items\n  ADD COLUMN stack_id INTEGER,\n  ADD COLUMN stack_position INTEGER;\n\n  -- Add index for stack-related queries\n  DROP INDEX IF EXISTS idx_layout_items_stack;\n  CREATE INDEX idx_layout_items_stack ON trailer_layout_items(stack_id, stack_position);\n\n  -- Add constraint to ensure stack_position is positive when present\n  ALTER TABLE trailer_layout_items\n  ADD CONSTRAINT check_stack_position \n  CHECK (stack_position IS NULL OR stack_position > 0);\n\n  -- Add constraint to ensure stack_id and stack_position are used together\n  ALTER TABLE trailer_layout_items\n  ADD CONSTRAINT check_stack_consistency\n  CHECK (\n      (stack_id IS NULL AND stack_position IS NULL) OR\n      (stack_id IS NOT NULL AND stack_position IS NOT NULL)\n  );\n  `\n];\nasync function runMigrations(pool) {\n    try {\n        console.log(\"Running database migrations...\");\n        for (const migration of MIGRATIONS){\n            await pool.query(migration);\n        }\n        console.log(\"Database migrations completed successfully\");\n    } catch (error) {\n        console.error(\"Error running migrations:\", error);\n        throw error;\n    }\n}\nfunction createPool() {\n    if (pool) return pool;\n    try {\n        const branchConfig = config[branch];\n        if (!branchConfig) {\n            throw new Error(`No configuration found for branch: ${branch}`);\n        }\n        pool = new pg__WEBPACK_IMPORTED_MODULE_0__.Pool({\n            ...branchConfig,\n            connectionTimeoutMillis: CONNECTION_TIMEOUT_MS,\n            idleTimeoutMillis: IDLE_TIMEOUT_MS,\n            max: MAX_POOL_SIZE,\n            // Force SSL mode\n            ssl: {\n                rejectUnauthorized: true\n            }\n        });\n        // Handle pool errors\n        pool.on(\"error\", (err)=>{\n            console.error(\"Unexpected error on idle client\", err);\n            // Reset pool on error\n            pool = null;\n        });\n        // Add connection logging\n        pool.on(\"connect\", ()=>{\n            console.log(\"New database connection established\");\n        });\n        pool.on(\"acquire\", ()=>{\n            console.log(\"Client acquired from pool\");\n        });\n        pool.on(\"remove\", ()=>{\n            console.log(\"Client removed from pool\");\n        });\n        // Run migrations\n        runMigrations(pool).catch((error)=>{\n            console.error(\"Failed to run migrations:\", error);\n            pool = null;\n            throw error;\n        });\n        return pool;\n    } catch (error) {\n        const errorMessage = error instanceof Error ? error.message : String(error);\n        console.error(`Error initializing database pool for ${branch} branch:`, errorMessage);\n        throw new Error(`Database connection error: ${errorMessage}`);\n    }\n}\n/**\n * Execute a SQL query on the database with retry logic\n */ async function query(text, params = [], retryCount = 0) {\n    const MAX_RETRIES = 2;\n    const start = Date.now();\n    try {\n        const currentPool = createPool();\n        if (!currentPool) {\n            throw new Error(\"Database pool not initialized\");\n        }\n        const res = await currentPool.query(text, params);\n        const duration = Date.now() - start;\n        // Only log if query took longer than 100ms for performance monitoring\n        if (duration > 100) {\n            console.log(\"Slow query detected\", {\n                text: text.substring(0, 50) + (text.length > 50 ? \"...\" : \"\"),\n                duration,\n                rows: res.rowCount\n            });\n        }\n        return res;\n    } catch (error) {\n        const duration = Date.now() - start;\n        // Retry on connection errors, but not on syntax or constraint errors\n        const isConnectionError = error.code === \"ECONNREFUSED\" || error.code === \"ETIMEDOUT\" || error.code === \"08006\" || // connection_failure\n        error.code === \"08001\"; // unable_to_connect\n        if (isConnectionError && retryCount < MAX_RETRIES) {\n            console.warn(`Database connection error, retrying (${retryCount + 1}/${MAX_RETRIES})...`);\n            // Reset pool on connection error\n            pool = null;\n            // Exponential backoff\n            const delay = Math.pow(2, retryCount) * 500;\n            await new Promise((resolve)=>setTimeout(resolve, delay));\n            return query(text, params, retryCount + 1);\n        }\n        console.error(\"Error executing query\", {\n            text: text.substring(0, 100),\n            error: error.message,\n            duration,\n            code: error.code,\n            detail: error.detail,\n            hint: error.hint,\n            position: error.position\n        });\n        throw error;\n    }\n}\n/**\n * Get a client from the pool for transactions\n */ async function getClient() {\n    const currentPool = createPool();\n    if (!currentPool) {\n        throw new Error(\"Database pool not initialized\");\n    }\n    try {\n        const client = await currentPool.connect();\n        return client;\n    } catch (error) {\n        const errorMessage = error instanceof Error ? error.message : String(error);\n        console.error(\"Error getting database client:\", errorMessage);\n        throw new Error(`Failed to get database client: ${errorMessage}`);\n    }\n}\n/**\n * Convenient wrapper for transactions\n */ async function withTransaction(callback) {\n    const currentPool = createPool();\n    if (!currentPool) {\n        throw new Error(\"Database pool not initialized\");\n    }\n    const client = await currentPool.connect();\n    try {\n        await client.query(\"BEGIN\");\n        const result = await callback(client);\n        await client.query(\"COMMIT\");\n        return result;\n    } catch (error) {\n        await client.query(\"ROLLBACK\");\n        console.error(\"Transaction error:\", error);\n        throw error;\n    } finally{\n        client.release();\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LFFBQVFyQixNQUFNOEIsT0FBTyxHQUFHQyxPQUFPL0I7UUFDckVDLFFBQVFELEtBQUssQ0FBQyxrQ0FBa0M2QjtRQUNoRCxNQUFNLElBQUlSLE1BQU0sQ0FBQywrQkFBK0IsRUFBRVEsYUFBYSxDQUFDO0lBQ2xFO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLGVBQWVnQyxnQkFBbUJDLFFBQXFDO0lBQzVFLE1BQU12QixjQUFjcEI7SUFDcEIsSUFBSSxDQUFDb0IsYUFBYTtRQUNoQixNQUFNLElBQUlsQixNQUFNO0lBQ2xCO0lBRUEsTUFBTXNDLFNBQVMsTUFBTXBCLFlBQVlxQixPQUFPO0lBRXhDLElBQUk7UUFDRixNQUFNRCxPQUFPekMsS0FBSyxDQUFDO1FBQ25CLE1BQU02QyxTQUFTLE1BQU1ELFNBQVNIO1FBQzlCLE1BQU1BLE9BQU96QyxLQUFLLENBQUM7UUFDbkIsT0FBTzZDO0lBQ1QsRUFBRSxPQUFPL0QsT0FBTztRQUNkLE1BQU0yRCxPQUFPekMsS0FBSyxDQUFDO1FBQ25CakIsUUFBUUQsS0FBSyxDQUFDLHNCQUFzQkE7UUFDcEMsTUFBTUE7SUFDUixTQUFVO1FBQ1IyRCxPQUFPSyxPQUFPO0lBQ2hCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90aW1iZXJsaW5lLWxvZ2lzdGljcy1kYXNoYm9hcmQvLi9saWIvZGIvaW5kZXgudHM/NmY5NCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQb29sIH0gZnJvbSAncGcnXG5cbi8vIFBhcnNlIGNvbm5lY3Rpb24gc3RyaW5nIHRvIGV4cGxpY2l0IGNvbmZpZ1xuZnVuY3Rpb24gcGFyc2VDb25uZWN0aW9uU3RyaW5nKGNvbm5lY3Rpb25TdHJpbmc6IHN0cmluZykge1xuICB0cnkge1xuICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoY29ubmVjdGlvblN0cmluZylcbiAgICByZXR1cm4ge1xuICAgICAgdXNlcjogdXJsLnVzZXJuYW1lLFxuICAgICAgcGFzc3dvcmQ6IHVybC5wYXNzd29yZCxcbiAgICAgIGhvc3Q6IHVybC5ob3N0bmFtZSxcbiAgICAgIHBvcnQ6IE51bWJlcih1cmwucG9ydCkgfHwgNTQzMixcbiAgICAgIGRhdGFiYXNlOiB1cmwucGF0aG5hbWUuc2xpY2UoMSksXG4gICAgICBzc2w6IHRydWVcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcGFyc2luZyBjb25uZWN0aW9uIHN0cmluZzonLCBlcnJvcilcbiAgICB0aHJvdyBlcnJvclxuICB9XG59XG5cbi8vIERhdGFiYXNlIGNvbmZpZ3VyYXRpb25cbmNvbnN0IGNvbmZpZyA9IHtcbiAgcHJldmlldzogcGFyc2VDb25uZWN0aW9uU3RyaW5nKFwicG9zdGdyZXNxbDovL25lb25kYl9vd25lcjpucGdfRDVoajFlZ1BsQW9rQGVwLXByb3VkLWdsaXR0ZXItYTg1cGJyejYtcG9vbGVyLmVhc3R1czIuYXp1cmUubmVvbi50ZWNoL25lb25kYj9zc2xtb2RlPXJlcXVpcmVcIiksXG4gIG1haW46IHBhcnNlQ29ubmVjdGlvblN0cmluZyhcInBvc3RncmVzcWw6Ly9uZW9uZGJfb3duZXI6bnBnX0Q1aGoxZWdQbEFva0BlcC1jYWxtLWZyb2ctYThxeHlvOG8tcG9vbGVyLmVhc3R1czIuYXp1cmUubmVvbi50ZWNoL25lb25kYj9zc2xtb2RlPXJlcXVpcmVcIilcbn1cblxuLy8gRGV0ZXJtaW5lIHdoaWNoIGRhdGFiYXNlIGJyYW5jaCB0byB1c2UgYmFzZWQgb24gZW52aXJvbm1lbnRcbmNvbnN0IGlzUHJvZHVjdGlvbiA9IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbidcbmNvbnN0IGJyYW5jaCA9IGlzUHJvZHVjdGlvbiA/ICdtYWluJyA6ICdwcmV2aWV3J1xuXG5jb25zb2xlLmxvZyhgVXNpbmcgZGF0YWJhc2UgYnJhbmNoOiAke2JyYW5jaH1gKTtcbmNvbnNvbGUubG9nKCdEYXRhYmFzZSBjb25maWc6Jywge1xuICBob3N0OiBjb25maWdbYnJhbmNoXS5ob3N0LFxuICBwb3J0OiBjb25maWdbYnJhbmNoXS5wb3J0LFxuICBkYXRhYmFzZTogY29uZmlnW2JyYW5jaF0uZGF0YWJhc2UsXG4gIHVzZXI6IGNvbmZpZ1ticmFuY2hdLnVzZXIsXG4gIC8vIHBhc3N3b3JkIGlzIG1hc2tlZCBmb3Igc2VjdXJpdHlcbiAgc3NsOiBjb25maWdbYnJhbmNoXS5zc2xcbn0pO1xuXG4vLyBDb25uZWN0aW9uIHBvb2wgc2V0dGluZ3NcbmNvbnN0IENPTk5FQ1RJT05fVElNRU9VVF9NUyA9IDEwMDAwXG5jb25zdCBJRExFX1RJTUVPVVRfTVMgPSAzMDAwMFxuY29uc3QgTUFYX1BPT0xfU0laRSA9IDIwXG5jb25zdCBDT05ORUNUSU9OX1JFVFJZX0FUVEVNUFRTID0gM1xuY29uc3QgQ09OTkVDVElPTl9SRVRSWV9ERUxBWV9NUyA9IDEwMDBcblxuLy8gQ3JlYXRlIGEgY29ubmVjdGlvbiBwb29sIHdpdGggZW5oYW5jZWQgc2V0dGluZ3NcbmxldCBwb29sOiBQb29sIHwgbnVsbCA9IG51bGxcblxuLy8gTWlncmF0aW9uIFNRTFxuY29uc3QgTUlHUkFUSU9OUyA9IFtcbiAgYFxuICAtLSBGaXggc3RhY2sgY29sdW1ucyBpbiB0cmFpbGVyX2xheW91dF9pdGVtc1xuICBBTFRFUiBUQUJMRSB0cmFpbGVyX2xheW91dF9pdGVtc1xuICBEUk9QIENPTlNUUkFJTlQgSUYgRVhJU1RTIGZrX3RyYWlsZXJfbGF5b3V0X2l0ZW1zX3N0YWNrO1xuXG4gIEFMVEVSIFRBQkxFIHRyYWlsZXJfbGF5b3V0X2l0ZW1zXG4gIERST1AgQ09OU1RSQUlOVCBJRiBFWElTVFMgY2hlY2tfc3RhY2tfcG9zaXRpb247XG5cbiAgQUxURVIgVEFCTEUgdHJhaWxlcl9sYXlvdXRfaXRlbXNcbiAgRFJPUCBDT05TVFJBSU5UIElGIEVYSVNUUyBjaGVja19zdGFja19pZF92aW55bDtcblxuICAtLSBFbnN1cmUgdGhlIGNvbHVtbnMgZXhpc3Qgd2l0aCBjb3JyZWN0IHR5cGVzXG4gIEFMVEVSIFRBQkxFIHRyYWlsZXJfbGF5b3V0X2l0ZW1zXG4gIERST1AgQ09MVU1OIElGIEVYSVNUUyBzdGFja19pZDtcblxuICBBTFRFUiBUQUJMRSB0cmFpbGVyX2xheW91dF9pdGVtc1xuICBEUk9QIENPTFVNTiBJRiBFWElTVFMgc3RhY2tfcG9zaXRpb247XG5cbiAgQUxURVIgVEFCTEUgdHJhaWxlcl9sYXlvdXRfaXRlbXNcbiAgQUREIENPTFVNTiBzdGFja19pZCBJTlRFR0VSLFxuICBBREQgQ09MVU1OIHN0YWNrX3Bvc2l0aW9uIElOVEVHRVI7XG5cbiAgLS0gQWRkIGluZGV4IGZvciBzdGFjay1yZWxhdGVkIHF1ZXJpZXNcbiAgRFJPUCBJTkRFWCBJRiBFWElTVFMgaWR4X2xheW91dF9pdGVtc19zdGFjaztcbiAgQ1JFQVRFIElOREVYIGlkeF9sYXlvdXRfaXRlbXNfc3RhY2sgT04gdHJhaWxlcl9sYXlvdXRfaXRlbXMoc3RhY2tfaWQsIHN0YWNrX3Bvc2l0aW9uKTtcblxuICAtLSBBZGQgY29uc3RyYWludCB0byBlbnN1cmUgc3RhY2tfcG9zaXRpb24gaXMgcG9zaXRpdmUgd2hlbiBwcmVzZW50XG4gIEFMVEVSIFRBQkxFIHRyYWlsZXJfbGF5b3V0X2l0ZW1zXG4gIEFERCBDT05TVFJBSU5UIGNoZWNrX3N0YWNrX3Bvc2l0aW9uIFxuICBDSEVDSyAoc3RhY2tfcG9zaXRpb24gSVMgTlVMTCBPUiBzdGFja19wb3NpdGlvbiA+IDApO1xuXG4gIC0tIEFkZCBjb25zdHJhaW50IHRvIGVuc3VyZSBzdGFja19pZCBhbmQgc3RhY2tfcG9zaXRpb24gYXJlIHVzZWQgdG9nZXRoZXJcbiAgQUxURVIgVEFCTEUgdHJhaWxlcl9sYXlvdXRfaXRlbXNcbiAgQUREIENPTlNUUkFJTlQgY2hlY2tfc3RhY2tfY29uc2lzdGVuY3lcbiAgQ0hFQ0sgKFxuICAgICAgKHN0YWNrX2lkIElTIE5VTEwgQU5EIHN0YWNrX3Bvc2l0aW9uIElTIE5VTEwpIE9SXG4gICAgICAoc3RhY2tfaWQgSVMgTk9UIE5VTEwgQU5EIHN0YWNrX3Bvc2l0aW9uIElTIE5PVCBOVUxMKVxuICApO1xuICBgXG5dXG5cbmFzeW5jIGZ1bmN0aW9uIHJ1bk1pZ3JhdGlvbnMocG9vbDogUG9vbCkge1xuICB0cnkge1xuICAgIGNvbnNvbGUubG9nKCdSdW5uaW5nIGRhdGFiYXNlIG1pZ3JhdGlvbnMuLi4nKVxuICAgIGZvciAoY29uc3QgbWlncmF0aW9uIG9mIE1JR1JBVElPTlMpIHtcbiAgICAgIGF3YWl0IHBvb2wucXVlcnkobWlncmF0aW9uKVxuICAgIH1cbiAgICBjb25zb2xlLmxvZygnRGF0YWJhc2UgbWlncmF0aW9ucyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5JylcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBydW5uaW5nIG1pZ3JhdGlvbnM6JywgZXJyb3IpXG4gICAgdGhyb3cgZXJyb3JcbiAgfVxufVxuXG5mdW5jdGlvbiBjcmVhdGVQb29sKCkge1xuICBpZiAocG9vbCkgcmV0dXJuIHBvb2w7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBicmFuY2hDb25maWcgPSBjb25maWdbYnJhbmNoXVxuICAgIGlmICghYnJhbmNoQ29uZmlnKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYE5vIGNvbmZpZ3VyYXRpb24gZm91bmQgZm9yIGJyYW5jaDogJHticmFuY2h9YClcbiAgICB9XG5cbiAgICBwb29sID0gbmV3IFBvb2woe1xuICAgICAgLi4uYnJhbmNoQ29uZmlnLFxuICAgICAgY29ubmVjdGlvblRpbWVvdXRNaWxsaXM6IENPTk5FQ1RJT05fVElNRU9VVF9NUyxcbiAgICAgIGlkbGVUaW1lb3V0TWlsbGlzOiBJRExFX1RJTUVPVVRfTVMsXG4gICAgICBtYXg6IE1BWF9QT09MX1NJWkUsXG4gICAgICAvLyBGb3JjZSBTU0wgbW9kZVxuICAgICAgc3NsOiB7XG4gICAgICAgIHJlamVjdFVuYXV0aG9yaXplZDogdHJ1ZVxuICAgICAgfVxuICAgIH0pXG4gICAgXG4gICAgLy8gSGFuZGxlIHBvb2wgZXJyb3JzXG4gICAgcG9vbC5vbignZXJyb3InLCAoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKCdVbmV4cGVjdGVkIGVycm9yIG9uIGlkbGUgY2xpZW50JywgZXJyKVxuICAgICAgLy8gUmVzZXQgcG9vbCBvbiBlcnJvclxuICAgICAgcG9vbCA9IG51bGxcbiAgICB9KVxuXG4gICAgLy8gQWRkIGNvbm5lY3Rpb24gbG9nZ2luZ1xuICAgIHBvb2wub24oJ2Nvbm5lY3QnLCAoKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygnTmV3IGRhdGFiYXNlIGNvbm5lY3Rpb24gZXN0YWJsaXNoZWQnKVxuICAgIH0pXG5cbiAgICBwb29sLm9uKCdhY3F1aXJlJywgKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coJ0NsaWVudCBhY3F1aXJlZCBmcm9tIHBvb2wnKVxuICAgIH0pXG5cbiAgICBwb29sLm9uKCdyZW1vdmUnLCAoKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygnQ2xpZW50IHJlbW92ZWQgZnJvbSBwb29sJylcbiAgICB9KVxuXG4gICAgLy8gUnVuIG1pZ3JhdGlvbnNcbiAgICBydW5NaWdyYXRpb25zKHBvb2wpLmNhdGNoKGVycm9yID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBydW4gbWlncmF0aW9uczonLCBlcnJvcilcbiAgICAgIHBvb2wgPSBudWxsXG4gICAgICB0aHJvdyBlcnJvclxuICAgIH0pXG5cbiAgICByZXR1cm4gcG9vbFxuICB9IGNhdGNoIChlcnJvcjogdW5rbm93bikge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKVxuICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGluaXRpYWxpemluZyBkYXRhYmFzZSBwb29sIGZvciAke2JyYW5jaH0gYnJhbmNoOmAsIGVycm9yTWVzc2FnZSlcbiAgICB0aHJvdyBuZXcgRXJyb3IoYERhdGFiYXNlIGNvbm5lY3Rpb24gZXJyb3I6ICR7ZXJyb3JNZXNzYWdlfWApXG4gIH1cbn1cblxuLyoqXG4gKiBFeGVjdXRlIGEgU1FMIHF1ZXJ5IG9uIHRoZSBkYXRhYmFzZSB3aXRoIHJldHJ5IGxvZ2ljXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBxdWVyeSh0ZXh0OiBzdHJpbmcsIHBhcmFtczogYW55W10gPSBbXSwgcmV0cnlDb3VudCA9IDApIHtcbiAgY29uc3QgTUFYX1JFVFJJRVMgPSAyXG4gIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKVxuICBcbiAgdHJ5IHtcbiAgICBjb25zdCBjdXJyZW50UG9vbCA9IGNyZWF0ZVBvb2woKVxuICAgIGlmICghY3VycmVudFBvb2wpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRGF0YWJhc2UgcG9vbCBub3QgaW5pdGlhbGl6ZWQnKVxuICAgIH1cbiAgICBcbiAgICBjb25zdCByZXMgPSBhd2FpdCBjdXJyZW50UG9vbC5xdWVyeSh0ZXh0LCBwYXJhbXMpXG4gICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRcbiAgICBcbiAgICAvLyBPbmx5IGxvZyBpZiBxdWVyeSB0b29rIGxvbmdlciB0aGFuIDEwMG1zIGZvciBwZXJmb3JtYW5jZSBtb25pdG9yaW5nXG4gICAgaWYgKGR1cmF0aW9uID4gMTAwKSB7XG4gICAgICBjb25zb2xlLmxvZygnU2xvdyBxdWVyeSBkZXRlY3RlZCcsIHsgXG4gICAgICAgIHRleHQ6IHRleHQuc3Vic3RyaW5nKDAsIDUwKSArICh0ZXh0Lmxlbmd0aCA+IDUwID8gJy4uLicgOiAnJyksIFxuICAgICAgICBkdXJhdGlvbiwgXG4gICAgICAgIHJvd3M6IHJlcy5yb3dDb3VudCBcbiAgICAgIH0pXG4gICAgfVxuICAgIFxuICAgIHJldHVybiByZXNcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgIGNvbnN0IGR1cmF0aW9uID0gRGF0ZS5ub3coKSAtIHN0YXJ0XG4gICAgXG4gICAgLy8gUmV0cnkgb24gY29ubmVjdGlvbiBlcnJvcnMsIGJ1dCBub3Qgb24gc3ludGF4IG9yIGNvbnN0cmFpbnQgZXJyb3JzXG4gICAgY29uc3QgaXNDb25uZWN0aW9uRXJyb3IgPSBlcnJvci5jb2RlID09PSAnRUNPTk5SRUZVU0VEJyB8fCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IuY29kZSA9PT0gJ0VUSU1FRE9VVCcgfHwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yLmNvZGUgPT09ICcwODAwNicgfHwgLy8gY29ubmVjdGlvbl9mYWlsdXJlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yLmNvZGUgPT09ICcwODAwMSc7ICAgLy8gdW5hYmxlX3RvX2Nvbm5lY3RcbiAgICBcbiAgICBpZiAoaXNDb25uZWN0aW9uRXJyb3IgJiYgcmV0cnlDb3VudCA8IE1BWF9SRVRSSUVTKSB7XG4gICAgICBjb25zb2xlLndhcm4oYERhdGFiYXNlIGNvbm5lY3Rpb24gZXJyb3IsIHJldHJ5aW5nICgke3JldHJ5Q291bnQgKyAxfS8ke01BWF9SRVRSSUVTfSkuLi5gKVxuICAgICAgLy8gUmVzZXQgcG9vbCBvbiBjb25uZWN0aW9uIGVycm9yXG4gICAgICBwb29sID0gbnVsbFxuICAgICAgLy8gRXhwb25lbnRpYWwgYmFja29mZlxuICAgICAgY29uc3QgZGVsYXkgPSBNYXRoLnBvdygyLCByZXRyeUNvdW50KSAqIDUwMFxuICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIGRlbGF5KSlcbiAgICAgIHJldHVybiBxdWVyeSh0ZXh0LCBwYXJhbXMsIHJldHJ5Q291bnQgKyAxKVxuICAgIH1cbiAgICBcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBleGVjdXRpbmcgcXVlcnknLCB7IFxuICAgICAgdGV4dDogdGV4dC5zdWJzdHJpbmcoMCwgMTAwKSwgXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICAgIGR1cmF0aW9uLFxuICAgICAgY29kZTogZXJyb3IuY29kZSxcbiAgICAgIGRldGFpbDogZXJyb3IuZGV0YWlsLFxuICAgICAgaGludDogZXJyb3IuaGludCxcbiAgICAgIHBvc2l0aW9uOiBlcnJvci5wb3NpdGlvblxuICAgIH0pXG4gICAgdGhyb3cgZXJyb3JcbiAgfVxufVxuXG4vKipcbiAqIEdldCBhIGNsaWVudCBmcm9tIHRoZSBwb29sIGZvciB0cmFuc2FjdGlvbnNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENsaWVudCgpIHtcbiAgY29uc3QgY3VycmVudFBvb2wgPSBjcmVhdGVQb29sKClcbiAgaWYgKCFjdXJyZW50UG9vbCkge1xuICAgIHRocm93IG5ldyBFcnJvcignRGF0YWJhc2UgcG9vbCBub3QgaW5pdGlhbGl6ZWQnKVxuICB9XG4gIFxuICB0cnkge1xuICAgIGNvbnN0IGNsaWVudCA9IGF3YWl0IGN1cnJlbnRQb29sLmNvbm5lY3QoKVxuICAgIHJldHVybiBjbGllbnRcbiAgfSBjYXRjaCAoZXJyb3I6IHVua25vd24pIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcilcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIGRhdGFiYXNlIGNsaWVudDonLCBlcnJvck1lc3NhZ2UpXG4gICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZ2V0IGRhdGFiYXNlIGNsaWVudDogJHtlcnJvck1lc3NhZ2V9YClcbiAgfVxufVxuXG4vKipcbiAqIENvbnZlbmllbnQgd3JhcHBlciBmb3IgdHJhbnNhY3Rpb25zXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB3aXRoVHJhbnNhY3Rpb248VD4oY2FsbGJhY2s6IChjbGllbnQ6IGFueSkgPT4gUHJvbWlzZTxUPik6IFByb21pc2U8VD4ge1xuICBjb25zdCBjdXJyZW50UG9vbCA9IGNyZWF0ZVBvb2woKVxuICBpZiAoIWN1cnJlbnRQb29sKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdEYXRhYmFzZSBwb29sIG5vdCBpbml0aWFsaXplZCcpXG4gIH1cbiAgXG4gIGNvbnN0IGNsaWVudCA9IGF3YWl0IGN1cnJlbnRQb29sLmNvbm5lY3QoKVxuICBcbiAgdHJ5IHtcbiAgICBhd2FpdCBjbGllbnQucXVlcnkoJ0JFR0lOJylcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsYmFjayhjbGllbnQpXG4gICAgYXdhaXQgY2xpZW50LnF1ZXJ5KCdDT01NSVQnKVxuICAgIHJldHVybiByZXN1bHRcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBhd2FpdCBjbGllbnQucXVlcnkoJ1JPTExCQUNLJylcbiAgICBjb25zb2xlLmVycm9yKCdUcmFuc2FjdGlvbiBlcnJvcjonLCBlcnJvcilcbiAgICB0aHJvdyBlcnJvclxuICB9IGZpbmFsbHkge1xuICAgIGNsaWVudC5yZWxlYXNlKClcbiAgfVxufSAiXSwibmFtZXMiOlsiUG9vbCIsInBhcnNlQ29ubmVjdGlvblN0cmluZyIsImNvbm5lY3Rpb25TdHJpbmciLCJ1cmwiLCJVUkwiLCJ1c2VyIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsImhvc3QiLCJob3N0bmFtZSIsInBvcnQiLCJOdW1iZXIiLCJkYXRhYmFzZSIsInBhdGhuYW1lIiwic2xpY2UiLCJzc2wiLCJlcnJvciIsImNvbnNvbGUiLCJjb25maWciLCJwcmV2aWV3IiwibWFpbiIsImlzUHJvZHVjdGlvbiIsInByb2Nlc3MiLCJicmFuY2giLCJsb2ciLCJDT05ORUNUSU9OX1RJTUVPVVRfTVMiLCJJRExFX1RJTUVPVVRfTVMiLCJNQVhfUE9PTF9TSVpFIiwiQ09OTkVDVElPTl9SRVRSWV9BVFRFTVBUUyIsIkNPTk5FQ1RJT05fUkVUUllfREVMQVlfTVMiLCJwb29sIiwiTUlHUkFUSU9OUyIsInJ1bk1pZ3JhdGlvbnMiLCJtaWdyYXRpb24iLCJxdWVyeSIsImNyZWF0ZVBvb2wiLCJicmFuY2hDb25maWciLCJFcnJvciIsImNvbm5lY3Rpb25UaW1lb3V0TWlsbGlzIiwiaWRsZVRpbWVvdXRNaWxsaXMiLCJtYXgiLCJyZWplY3RVbmF1dGhvcml6ZWQiLCJvbiIsImVyciIsImNhdGNoIiwiZXJyb3JNZXNzYWdlIiwibWVzc2FnZSIsIlN0cmluZyIsInRleHQiLCJwYXJhbXMiLCJyZXRyeUNvdW50IiwiTUFYX1JFVFJJRVMiLCJzdGFydCIsIkRhdGUiLCJub3ciLCJjdXJyZW50UG9vbCIsInJlcyIsImR1cmF0aW9uIiwic3Vic3RyaW5nIiwibGVuZ3RoIiwicm93cyIsInJvd0NvdW50IiwiaXNDb25uZWN0aW9uRXJyb3IiLCJjb2RlIiwid2FybiIsImRlbGF5IiwiTWF0aCIsInBvdyIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsImRldGFpbCIsImhpbnQiLCJwb3NpdGlvbiIsImdldENsaWVudCIsImNsaWVudCIsImNvbm5lY3QiLCJ3aXRoVHJhbnNhY3Rpb24iLCJjYWxsYmFjayIsInJlc3VsdCIsInJlbGVhc2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/db/index.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/next-auth","vendor-chunks/@babel","vendor-chunks/@neondatabase","vendor-chunks/jose","vendor-chunks/ws","vendor-chunks/openid-client","vendor-chunks/bcryptjs","vendor-chunks/oauth","vendor-chunks/object-hash","vendor-chunks/preact","vendor-chunks/preact-render-to-string","vendor-chunks/yallist","vendor-chunks/lru-cache","vendor-chunks/cookie","vendor-chunks/@vercel","vendor-chunks/node-gyp-build","vendor-chunks/oidc-token-hash","vendor-chunks/@panva","vendor-chunks/bufferutil"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Ftruckloads%2F%5Bid%5D%2Flayout%2Froute&page=%2Fapi%2Ftruckloads%2F%5Bid%5D%2Flayout%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Ftruckloads%2F%5Bid%5D%2Flayout%2Froute.ts&appDir=%2FUsers%2Freeceschlabach%2FDesktop%2FTimberline%20Internal%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Freeceschlabach%2FDesktop%2FTimberline%20Internal&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();